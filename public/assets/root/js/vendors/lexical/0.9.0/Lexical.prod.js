var Ii=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var _c=Ii((yc,v)=>{function y(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}y(v.exports,"$addUpdateTag",function(){return kt},function(t){return kt=t});y(v.exports,"$applyNodeReplacement",function(){return It},function(t){return It=t});y(v.exports,"$copyNode",function(){return Rt},function(t){return Rt=t});y(v.exports,"$createLineBreakNode",function(){return Lt},function(t){return Lt=t});y(v.exports,"$createNodeSelection",function(){return Ft},function(t){return Ft=t});y(v.exports,"$createParagraphNode",function(){return Kt},function(t){return Kt=t});y(v.exports,"$createRangeSelection",function(){return Bt},function(t){return Bt=t});y(v.exports,"$createTextNode",function(){return zt},function(t){return zt=t});y(v.exports,"$getAdjacentNode",function(){return Wt},function(t){return Wt=t});y(v.exports,"$getNearestNodeFromDOMNode",function(){return Ut},function(t){return Ut=t});y(v.exports,"$getNearestRootOrShadowRoot",function(){return Gt},function(t){return Gt=t});y(v.exports,"$getNodeByKey",function(){return Yt},function(t){return Yt=t});y(v.exports,"$getPreviousSelection",function(){return Ht},function(t){return Ht=t});y(v.exports,"$getRoot",function(){return Vt},function(t){return Vt=t});y(v.exports,"$getSelection",function(){return Jt},function(t){return Jt=t});y(v.exports,"$getTextContent",function(){return jt},function(t){return jt=t});y(v.exports,"$hasAncestor",function(){return Xt},function(t){return Xt=t});y(v.exports,"$insertNodes",function(){return qt},function(t){return qt=t});y(v.exports,"$isDecoratorNode",function(){return Qt},function(t){return Qt=t});y(v.exports,"$isElementNode",function(){return Zt},function(t){return Zt=t});y(v.exports,"$isInlineElementOrDecoratorNode",function(){return en},function(t){return en=t});y(v.exports,"$isLeafNode",function(){return tn},function(t){return tn=t});y(v.exports,"$isLineBreakNode",function(){return nn},function(t){return nn=t});y(v.exports,"$isNodeSelection",function(){return rn},function(t){return rn=t});y(v.exports,"$isParagraphNode",function(){return on},function(t){return on=t});y(v.exports,"$isRangeSelection",function(){return sn},function(t){return sn=t});y(v.exports,"$isRootNode",function(){return an},function(t){return an=t});y(v.exports,"$isRootOrShadowRoot",function(){return ln},function(t){return ln=t});y(v.exports,"$isTextNode",function(){return cn},function(t){return cn=t});y(v.exports,"$nodesOfType",function(){return fn},function(t){return fn=t});y(v.exports,"$normalizeSelection__EXPERIMENTAL",function(){return dn},function(t){return dn=t});y(v.exports,"$parseSerializedNode",function(){return un},function(t){return un=t});y(v.exports,"$setCompositionKey",function(){return hn},function(t){return hn=t});y(v.exports,"$setSelection",function(){return $n},function(t){return $n=t});y(v.exports,"$splitNode",function(){return gn},function(t){return gn=t});y(v.exports,"BLUR_COMMAND",function(){return pn},function(t){return pn=t});y(v.exports,"CAN_REDO_COMMAND",function(){return _n},function(t){return _n=t});y(v.exports,"CAN_UNDO_COMMAND",function(){return vn},function(t){return vn=t});y(v.exports,"CLEAR_EDITOR_COMMAND",function(){return yn},function(t){return yn=t});y(v.exports,"CLEAR_HISTORY_COMMAND",function(){return xn},function(t){return xn=t});y(v.exports,"CLICK_COMMAND",function(){return mn},function(t){return mn=t});y(v.exports,"COMMAND_PRIORITY_CRITICAL",function(){return Nn},function(t){return Nn=t});y(v.exports,"COMMAND_PRIORITY_EDITOR",function(){return Tn},function(t){return Tn=t});y(v.exports,"COMMAND_PRIORITY_HIGH",function(){return En},function(t){return En=t});y(v.exports,"COMMAND_PRIORITY_LOW",function(){return Cn},function(t){return Cn=t});y(v.exports,"COMMAND_PRIORITY_NORMAL",function(){return Sn},function(t){return Sn=t});y(v.exports,"CONTROLLED_TEXT_INSERTION_COMMAND",function(){return On},function(t){return On=t});y(v.exports,"COPY_COMMAND",function(){return bn},function(t){return bn=t});y(v.exports,"CUT_COMMAND",function(){return Mn},function(t){return Mn=t});y(v.exports,"DELETE_CHARACTER_COMMAND",function(){return Dn},function(t){return Dn=t});y(v.exports,"DELETE_LINE_COMMAND",function(){return wn},function(t){return wn=t});y(v.exports,"DELETE_WORD_COMMAND",function(){return An},function(t){return An=t});y(v.exports,"DEPRECATED_$createGridSelection",function(){return Pn},function(t){return Pn=t});y(v.exports,"DEPRECATED_$isGridCellNode",function(){return kn},function(t){return kn=t});y(v.exports,"DEPRECATED_$isGridNode",function(){return In},function(t){return In=t});y(v.exports,"DEPRECATED_$isGridRowNode",function(){return Rn},function(t){return Rn=t});y(v.exports,"DEPRECATED_$isGridSelection",function(){return Ln},function(t){return Ln=t});y(v.exports,"DEPRECATED_GridCellNode",function(){return Fn},function(t){return Fn=t});y(v.exports,"DEPRECATED_GridNode",function(){return Kn},function(t){return Kn=t});y(v.exports,"DEPRECATED_GridRowNode",function(){return Bn},function(t){return Bn=t});y(v.exports,"DRAGEND_COMMAND",function(){return zn},function(t){return zn=t});y(v.exports,"DRAGOVER_COMMAND",function(){return Wn},function(t){return Wn=t});y(v.exports,"DRAGSTART_COMMAND",function(){return Un},function(t){return Un=t});y(v.exports,"DROP_COMMAND",function(){return Gn},function(t){return Gn=t});y(v.exports,"DecoratorNode",function(){return Yn},function(t){return Yn=t});y(v.exports,"ElementNode",function(){return Hn},function(t){return Hn=t});y(v.exports,"FOCUS_COMMAND",function(){return Vn},function(t){return Vn=t});y(v.exports,"FORMAT_ELEMENT_COMMAND",function(){return Jn},function(t){return Jn=t});y(v.exports,"FORMAT_TEXT_COMMAND",function(){return jn},function(t){return jn=t});y(v.exports,"INDENT_CONTENT_COMMAND",function(){return Xn},function(t){return Xn=t});y(v.exports,"INSERT_LINE_BREAK_COMMAND",function(){return qn},function(t){return qn=t});y(v.exports,"INSERT_PARAGRAPH_COMMAND",function(){return Qn},function(t){return Qn=t});y(v.exports,"KEY_ARROW_DOWN_COMMAND",function(){return Zn},function(t){return Zn=t});y(v.exports,"KEY_ARROW_LEFT_COMMAND",function(){return er},function(t){return er=t});y(v.exports,"KEY_ARROW_RIGHT_COMMAND",function(){return tr},function(t){return tr=t});y(v.exports,"KEY_ARROW_UP_COMMAND",function(){return nr},function(t){return nr=t});y(v.exports,"KEY_BACKSPACE_COMMAND",function(){return rr},function(t){return rr=t});y(v.exports,"KEY_DELETE_COMMAND",function(){return or},function(t){return or=t});y(v.exports,"KEY_DOWN_COMMAND",function(){return sr},function(t){return sr=t});y(v.exports,"KEY_ENTER_COMMAND",function(){return ir},function(t){return ir=t});y(v.exports,"KEY_ESCAPE_COMMAND",function(){return ar},function(t){return ar=t});y(v.exports,"KEY_MODIFIER_COMMAND",function(){return lr},function(t){return lr=t});y(v.exports,"KEY_SPACE_COMMAND",function(){return cr},function(t){return cr=t});y(v.exports,"KEY_TAB_COMMAND",function(){return fr},function(t){return fr=t});y(v.exports,"LineBreakNode",function(){return dr},function(t){return dr=t});y(v.exports,"MOVE_TO_END",function(){return ur},function(t){return ur=t});y(v.exports,"MOVE_TO_START",function(){return hr},function(t){return hr=t});y(v.exports,"OUTDENT_CONTENT_COMMAND",function(){return $r},function(t){return $r=t});y(v.exports,"PASTE_COMMAND",function(){return gr},function(t){return gr=t});y(v.exports,"ParagraphNode",function(){return pr},function(t){return pr=t});y(v.exports,"REDO_COMMAND",function(){return _r},function(t){return _r=t});y(v.exports,"REMOVE_TEXT_COMMAND",function(){return vr},function(t){return vr=t});y(v.exports,"RootNode",function(){return yr},function(t){return yr=t});y(v.exports,"SELECTION_CHANGE_COMMAND",function(){return xr},function(t){return xr=t});y(v.exports,"TextNode",function(){return mr},function(t){return mr=t});y(v.exports,"UNDO_COMMAND",function(){return Nr},function(t){return Nr=t});y(v.exports,"createCommand",function(){return Tr},function(t){return Tr=t});y(v.exports,"createEditor",function(){return Er},function(t){return Er=t});y(v.exports,"isSelectionWithinEditor",function(){return Cr},function(t){return Cr=t});var kt,It,Rt,Lt,Ft,Kt,Bt,zt,Wt,Ut,Gt,Yt,Ht,Vt,Jt,jt,Xt,qt,Qt,Zt,en,tn,nn,rn,on,sn,an,ln,cn,fn,dn,un,hn,$n,gn,pn,_n,vn,yn,xn,mn,Nn,Tn,En,Cn,Sn,On,bn,Mn,Dn,wn,An,Pn,kn,In,Rn,Ln,Fn,Kn,Bn,zn,Wn,Un,Gn,Yn,Hn,Vn,Jn,jn,Xn,qn,Qn,Zn,er,tr,nr,rr,or,sr,ir,ar,lr,cr,fr,dr,ur,hr,$r,gr,pr,_r,vr,yr,xr,mr,Nr,Tr,Er,Cr;function D(t){return{type:t}}const Sr=D("SELECTION_CHANGE_COMMAND"),Io=D("CLICK_COMMAND"),Fe=D("DELETE_CHARACTER_COMMAND"),Ke=D("INSERT_LINE_BREAK_COMMAND"),Or=D("INSERT_PARAGRAPH_COMMAND"),Se=D("CONTROLLED_TEXT_INSERTION_COMMAND"),br=D("PASTE_COMMAND"),Mr=D("REMOVE_TEXT_COMMAND"),Be=D("DELETE_WORD_COMMAND"),ze=D("DELETE_LINE_COMMAND"),ce=D("FORMAT_TEXT_COMMAND"),Dr=D("UNDO_COMMAND"),wr=D("REDO_COMMAND"),Ro=D("KEYDOWN_COMMAND"),Lo=D("KEY_ARROW_RIGHT_COMMAND"),Fo=D("MOVE_TO_END"),Ko=D("KEY_ARROW_LEFT_COMMAND"),Bo=D("MOVE_TO_START"),zo=D("KEY_ARROW_UP_COMMAND"),Wo=D("KEY_ARROW_DOWN_COMMAND"),st=D("KEY_ENTER_COMMAND"),Uo=D("KEY_SPACE_COMMAND"),Go=D("KEY_BACKSPACE_COMMAND"),Yo=D("KEY_ESCAPE_COMMAND"),Ho=D("KEY_DELETE_COMMAND"),Vo=D("KEY_TAB_COMMAND"),Ri=D("INDENT_CONTENT_COMMAND"),Li=D("OUTDENT_CONTENT_COMMAND"),Jo=D("DROP_COMMAND"),Fi=D("FORMAT_ELEMENT_COMMAND"),jo=D("DRAGSTART_COMMAND"),Xo=D("DRAGOVER_COMMAND"),qo=D("DRAGEND_COMMAND"),Ar=D("COPY_COMMAND"),Pr=D("CUT_COMMAND"),Ki=D("CLEAR_EDITOR_COMMAND"),Bi=D("CLEAR_HISTORY_COMMAND"),zi=D("CAN_REDO_COMMAND"),Wi=D("CAN_UNDO_COMMAND"),Qo=D("FOCUS_COMMAND"),Zo=D("BLUR_COMMAND"),es=D("KEY_MODIFIER_COMMAND"),oe=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",Ui=oe&&"documentMode"in document?document.documentMode:null,Q=oe&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),pe=oe&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),it=oe&&"InputEvent"in window&&!Ui?"getTargetRanges"in new window.InputEvent("input"):!1,kr=oe&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),Ir=oe&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Gi=oe&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Rr=oe&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!Gi,ts=1,We=3,_e=0,ns=1,Oe=2,rs=0,Lr=1,Fr=2,Kr=1,Br=2,at=4,lt=8,zr=16,Wr=32,Ur=64,Gr=128,Yi=Kr|Br|at|lt|zr|Wr|Ur|Gr,Yr=1,Hr=2,Vr=1,Jr=2,jr=3,Xr=4,qr=5,Qr=6,os="\xA0",Hi="\u200B",ct=kr||Ir||Rr?os:Hi,se=`

`,Vi=pe?os:ct,ss="\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC",is="A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF\u200E\u2C00-\uFB1C\uFE00-\uFE6F\uFEFD-\uFFFF",Ji=new RegExp("^[^"+is+"]*["+ss+"]"),ji=new RegExp("^[^"+ss+"]*["+is+"]"),ve={bold:Kr,code:zr,highlight:Gr,italic:Br,strikethrough:at,subscript:Wr,superscript:Ur,underline:lt},Xi={directionless:Yr,unmergeable:Hr},as={center:Jr,end:Qr,justify:Xr,left:Vr,right:jr,start:qr},qi={[Jr]:"center",[Qr]:"end",[Xr]:"justify",[Vr]:"left",[jr]:"right",[qr]:"start"},Qi={normal:rs,segmented:Fr,token:Lr},Zi={[rs]:"normal",[Fr]:"segmented",[Lr]:"token"},ea=100;let Zr=!1,eo=0;function ta(){return Zr}function na(t){eo=t.timeStamp}function ra(t){eo===0&&_t(t).addEventListener("textInput",na,!0)}function to(t,e,n){return e.__lexicalLineBreak===t||t[`__lexicalKey_${n._key}`]!==void 0}function oa(t){return t.getEditorState().read(()=>{const e=P();return e!==null?e.clone():null})}function sa(t,e,n){const r=ee(n._window);let o=null,s=null;r!==null&&r.anchorNode===t&&(o=r.anchorOffset,s=r.focusOffset);const i=t.nodeValue;i!==null&&so(e,i,o,s,!1)}function ia(t,e,n){if(M(t)){const r=t.anchor.getNode();if(r.is(n)&&t.format!==r.getFormat())return!1}return e.nodeType===We&&n.isAttached()}function ls(t,e,n){Zr=!0;const r=performance.now()-eo>ea;try{X(t,()=>{const o=P()||oa(t),s=new Map,i=t.getRootElement(),a=t._editorState,l=t._blockCursorElement;let c=!1,f="";for(let u=0;u<e.length;u++){const d=e[u],g=d.type,$=d.target;let p=Ge($,a);if(!(p===null&&$!==i||k(p))){if(g==="characterData")r&&E(p)&&ia(o,$,p)&&sa($,p,t);else if(g==="childList"){c=!0;const N=d.addedNodes;for(let O=0;O<N.length;O++){const C=N[O],S=ps(C),b=C.parentNode;if(b!=null&&C!==l&&S===null&&(C.nodeName!=="BR"||!to(C,b,t))){if(pe){const w=C.innerText||C.nodeValue;w&&(f+=w)}b.removeChild(C)}}const _=d.removedNodes,x=_.length;if(x>0){let O=0;for(let C=0;C<x;C++){const S=_[C];(S.nodeName==="BR"&&to(S,$,t)||l===S)&&($.appendChild(S),O++)}x!==O&&($===i&&(p=ys(a)),s.set($,p))}}}}if(s.size>0)for(const[u,d]of s)if(m(d)){const g=d.getChildrenKeys();let $=u.firstChild;for(let p=0;p<g.length;p++){const N=g[p],_=t.getElementByKey(N);_!==null&&($==null?(u.appendChild(_),$=_):$!==_&&u.replaceChild(_,$),$=$.nextSibling)}}else E(d)&&d.markDirty();const h=n.takeRecords();if(h.length>0){for(let u=0;u<h.length;u++){const d=h[u],g=d.addedNodes,$=d.target;for(let p=0;p<g.length;p++){const N=g[p],_=N.parentNode;_!=null&&N.nodeName==="BR"&&!to(N,$,t)&&_.removeChild(N)}}n.takeRecords()}o!==null&&(c&&(o.dirty=!0,de(o)),pe&&bs(t)&&o.insertRawText(f))})}finally{Zr=!1}}function cs(t){const e=t._observer;if(e!==null){const n=e.takeRecords();ls(t,n,e)}}function fs(t){ra(t),t._observer=new MutationObserver((e,n)=>{ls(t,e,n)})}let aa=1;function la(){return""+aa++}function ca(t,e){const n=t._nodes.get(e);if(n===void 0)throw Error(`registeredNode: Type ${e} not found`);return n}const fa=typeof queueMicrotask=="function"?queueMicrotask:t=>{Promise.resolve().then(t)};function da(t){return k(Ge(t))}function ds(t){const e=document.activeElement;if(e===null)return!1;const n=e.nodeName;return k(Ge(t))&&(n==="INPUT"||n==="TEXTAREA"||e.contentEditable==="true"&&e.__lexicalEditor==null)}function Ue(t,e,n){const r=t.getRootElement();try{return r!==null&&r.contains(e)&&r.contains(n)&&e!==null&&!ds(e)&&us(e)===t}catch{return!1}}function us(t){let e=t;for(;e!=null;){const n=e.__lexicalEditor;if(n!=null)return n;e=gt(e)}return null}function ua(t){return Ji.test(t)?"rtl":ji.test(t)?"ltr":null}function no(t){return t.isToken()||t.isSegmented()}function ha(t){return t.nodeType===We}function ft(t){let e=t;for(;e!=null;){if(ha(e))return e;e=e.firstChild}return null}function hs(t,e,n){const r=ve[e];return t&r&&(n===null||(n&r)==0)?t^r:n===null||n&r?t|r:t}function $s(t){return E(t)||ot(t)||k(t)}function gs(t,e){if(e!=null){t.__key=e;return}G(),_i();const n=I(),r=ne(),o=la();r._nodeMap.set(o,t),m(t)?n._dirtyElements.set(o,!0):n._dirtyLeaves.add(o),n._cloneNotNeeded.add(o),n._dirtyType=ns,t.__key=o}function $a(t,e,n){let r=t;for(;r!==null;){if(n.has(r))return;const o=e.get(r);if(o===void 0)break;n.set(r,!1),r=o.__parent}}function ye(t){const e=t.getParent();if(e!==null){const n=t.getWritable(),r=e.getWritable(),o=t.getPreviousSibling(),s=t.getNextSibling();if(o===null)if(s!==null){const i=s.getWritable();r.__first=s.__key,i.__prev=null}else r.__first=null;else{const i=o.getWritable();if(s!==null){const a=s.getWritable();a.__prev=i.__key,i.__next=a.__key}else i.__next=null;n.__prev=null}if(s===null)if(o!==null){const i=o.getWritable();r.__last=o.__key,i.__next=null}else r.__last=null;else{const i=s.getWritable();if(o!==null){const a=o.getWritable();a.__next=i.__key,i.__prev=a.__key}else i.__prev=null;n.__next=null}r.__size--,n.__parent=null}}function dt(t){_i();const e=t.getLatest(),n=e.__parent,r=ne(),o=I(),s=r._nodeMap,i=o._dirtyElements;n!==null&&$a(n,s,i);const a=e.__key;o._dirtyType=ns,m(t)?i.set(a,!0):o._dirtyLeaves.add(a)}function ga(t){const e=t.getPreviousSibling(),n=t.getNextSibling();e!==null&&dt(e),n!==null&&dt(n)}function z(t){G();const e=I(),n=e._compositionKey;if(t!==n){if(e._compositionKey=t,n!==null){const r=F(n);r!==null&&r.getWritable()}if(t!==null){const r=F(t);r!==null&&r.getWritable()}}}function fe(){return we()?null:I()._compositionKey}function F(t,e){const r=(e||ne())._nodeMap.get(t);return r===void 0?null:r}function ps(t,e){const n=I(),r=t[`__lexicalKey_${n._key}`];return r!==void 0?F(r,e):null}function Ge(t,e){let n=t;for(;n!=null;){const r=ps(n,e);if(r!==null)return r;n=gt(n)}return null}function _s(t){const e=t._decorators,n=Object.assign({},e);return t._pendingDecorators=n,n}function vs(t){return t.read(()=>ie().getTextContent())}function pa(t,e){X(t,()=>{const n=ne();if(n.isEmpty())return;if(e==="root"){ie().markDirty();return}const r=n._nodeMap;for(const[,o]of r)o.markDirty()},t._pendingEditorState===null?{tag:"history-merge"}:void 0)}function ie(){return ys(ne())}function ys(t){return t._nodeMap.get("root")}function de(t){G();const e=ne();if(t!==null){if(Object.isFrozen(t))throw Error("$setSelection called on frozen selection object. Ensure selection is cloned before passing in.");t.dirty=!0,t._cachedNodes=null}e._selection=t}function _a(){G();const t=I();cs(t)}function be(t){const e=I(),n=va(t,e);if(n===null){const r=e.getRootElement();return t===r?F("root"):null}return F(n)}function xs(t,e){return e?t.getTextContentSize():0}function va(t,e){let n=t;for(;n!=null;){const r=n[`__lexicalKey_${e._key}`];if(r!==void 0)return r;n=gt(n)}return null}function ms(t){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(t)}function ro(t){const e=[];let n=t;for(;n!==null;)e.push(n),n=n._parentEditor;return e}function Ns(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}function Ts(t){return t.nodeType===We?t.nodeValue:null}function oo(t,e,n){const r=ee(e._window);if(r===null)return;const o=r.anchorNode;let{anchorOffset:s,focusOffset:i}=r;if(o!==null){let a=Ts(o);const l=Ge(o);if(a!==null&&E(l)){if(l.canContainTabs()){const c=a.includes("	");if(n&&n.length>0&&c){const f=n.length,h=s+f-1,u=a.slice(0,h),d=a.slice(h,a.length);a=`${u}${n}${d}`,s+=f,i+=f}}if(a===ct&&n){const c=n.length;a=n,s=c,i=c}a!==null&&so(l,a,s,i,t)}}}function so(t,e,n,r,o){let s=t;if(s.isAttached()&&(o||!s.isDirty())){const i=s.isComposing();let a=e;(i||o)&&e[e.length-1]===ct&&(a=e.slice(0,-1));const l=s.getTextContent();if(o||a!==l){if(a===""){if(z(null),!kr&&!Ir&&!Rr){const g=I();setTimeout(()=>{g.update(()=>{s.isAttached()&&s.remove()})},20)}else s.remove();return}const c=s.getParent(),f=nt(),h=fe(),u=s.getKey();if(s.isToken()||h!==null&&u===h&&!i||c!==null&&M(f)&&!c.canInsertTextBefore()&&f.anchor.offset===0){s.markDirty();return}const d=P();if(!M(d)||n===null||r===null){s.setTextContent(a);return}if(d.setTextNodeRange(s,n,s,r),s.isSegmented()){const g=s.getTextContent(),$=W(g);s.replace($),s=$}s.setTextContent(a)}}}function ya(t){const e=t.getPreviousSibling();return(E(e)||m(e)&&e.isInline())&&!e.canInsertTextAfter()}function xa(t,e){if(e.isSegmented())return!0;if(!t.isCollapsed())return!1;const n=t.anchor.offset,r=e.getParentOrThrow(),o=e.isToken();return n===0?!e.canInsertTextBefore()||!r.canInsertTextBefore()||o||ya(e):n===e.getTextContentSize()?!e.canInsertTextAfter()||!r.canInsertTextAfter()||o:!1}function ma(t,e,n,r){return t===9&&!e&&!n&&!r}function Na(t,e,n,r){return t===66&&!e&&ut(n,r)}function Ta(t,e,n,r){return t===73&&!e&&ut(n,r)}function Ea(t,e,n,r){return t===85&&!e&&ut(n,r)}function Ca(t,e){return Ss(t)&&!e}function Sa(t,e){return Ss(t)&&e}function Oa(t,e){return Q&&e&&t===79}function ba(t,e,n){return Ye(t)&&(Q?e:n)}function Ma(t,e,n){return He(t)&&(Q?e:n)}function Da(t,e){return Q&&e&&Ye(t)}function wa(t,e){return Q&&e&&He(t)}function Aa(t,e,n,r){return Q?e||n?!1:Ye(t)||t===72&&r:r||e||n?!1:Ye(t)}function Pa(t,e,n,r,o){return Q?n||r||o?!1:He(t)||t===68&&e:e||r||o?!1:He(t)}function ka(t,e,n,r){return t===90&&!e&&ut(n,r)}function Ia(t,e,n,r){return Q?t===90&&n&&e:t===89&&r||t===90&&r&&e}function Ra(t,e,n,r){return e?!1:t===67?Q?n:r:!1}function La(t,e,n,r){return e?!1:t===88?Q?n:r:!1}function Es(t){return t===37}function Cs(t){return t===39}function Fa(t){return t===38}function Ka(t){return t===40}function Ba(t,e,n,r){return Es(t)&&!e&&!r&&!n}function za(t,e,n,r,o){return Es(t)&&!r&&!n&&(e||o)}function Wa(t,e,n,r){return Cs(t)&&!e&&!r&&!n}function Ua(t,e,n,r,o){return Cs(t)&&!r&&!n&&(e||o)}function Ga(t,e,n){return Fa(t)&&!e&&!n}function Ya(t,e,n){return Ka(t)&&!e&&!n}function Ha(t,e,n,r){return t||e||n||r}function Va(t){return t===32}function ut(t,e){return Q?t:e}function Ss(t){return t===13}function Ye(t){return t===8}function Ja(t){return t===27}function He(t){return t===46}function Ve(t,e){const n=t[e];if(typeof n=="string"){const r=n.split(" ");return t[e]=r,r}return n}function io(t,e,n,r,o){if(n.size===0)return;const s=r.__type,i=r.__key,a=e.get(s);if(a===void 0)throw Error(`Type ${s} not in registeredNodes`);const l=a.klass;let c=t.get(l);c===void 0&&(c=new Map,t.set(l,c));const f=c.get(i),h=f==="destroyed"&&o==="created";(f===void 0||h)&&c.set(i,h?"updated":o)}function ja(t){const e=ne(),n=e._readOnly,r=t.getType(),o=e._nodeMap,s=[];for(const[,i]of o)i instanceof t&&i.__type===r&&(n||i.isAttached())&&s.push(i);return s}function Os(t,e,n){const r=t.getParent();let o=n,s=t;return r!==null&&(e&&n===0?(o=s.getIndexWithinParent(),s=r):!e&&n===s.getChildrenSize()&&(o=s.getIndexWithinParent()+1,s=r)),s.getChildAtIndex(e?o-1:o)}function ao(t,e){const n=t.offset;if(t.type==="element"){const r=t.getNode();return Os(r,e,n)}else{const r=t.getNode();if(e&&n===0||!e&&n===r.getTextContentSize()){const o=e?r.getPreviousSibling():r.getNextSibling();return o===null?Os(r.getParentOrThrow(),e,r.getIndexWithinParent()+(e?0:1)):o}}return null}function bs(t){const e=_t(t).event,n=e&&e.inputType;return n==="insertFromPaste"||n==="insertFromPasteAsQuotation"}function T(t,e,n){return Ni(t,e,n)}function ht(t){return!j(t)&&!t.isLastChild()&&!t.isInline()}function $t(t,e){const n=t._keyToDOMMap.get(e);if(n===void 0)throw Error(`Reconciliation: could not find DOM element for node key ${e}`);return n}function gt(t){const e=t.assignedSlot||t.parentElement;return e!==null&&e.nodeType===11?e.host:e}function Xa(t,e,n){const r=n.ownerDocument,o=r.defaultView;if(o===null)return;let{top:s,bottom:i}=e,a=0,l=0,c=n;for(;c!==null;){const f=c===r.body;if(f)a=0,l=_t(t).innerHeight;else{const u=c.getBoundingClientRect();a=u.top,l=u.bottom}let h=0;if(s<a?h=-(a-s):i>l&&(h=i-l),h!==0)if(f)o.scrollBy(0,h);else{const u=c.scrollTop;c.scrollTop+=h;const d=c.scrollTop-u;s-=d,i-=d}if(f)break;c=gt(c)}}function qa(t){G(),I()._updateTags.add(t)}function Qa(t,e=0){if(e!==0)throw Error("TODO");const n=P();if(!M(n)||!m(t))return n;const{anchor:r,focus:o}=n,s=r.getNode(),i=o.getNode();return pt(s,t)&&r.set(t.__key,0,"element"),pt(i,t)&&o.set(t.__key,0,"element"),n}function pt(t,e){let n=t.getParent();for(;n!==null;){if(n.is(e))return!0;n=n.getParent()}return!1}function Za(t){const e=t.ownerDocument;return e&&e.defaultView||null}function _t(t){const e=t._window;if(e===null)throw Error("window object not found");return e}function el(t){return m(t)&&t.isInline()||k(t)&&t.isInline()}function Ms(t){let e=t.getParentOrThrow();for(;e!==null;){if(Z(e))return e;e=e.getParentOrThrow()}return e}function Z(t){return j(t)||m(t)&&t.isShadowRoot()}function Ds(t){const e=t.constructor.clone(t);return gs(e,null),e}function vt(t){const e=I(),n=t.constructor.getType(),r=e._nodes.get(n);if(r===void 0)throw Error('$initializeNode failed. Ensure node has been registered to the editor. You can do this by passing the node class via the "nodes" array in the editor config.');const o=r.replace;if(o!==null){const s=o(t);if(!(s instanceof t.constructor))throw Error("$initializeNode failed. Ensure replacement node is a subclass of the original node.");return s}return t}function lo(t,e){const n=t.getParent();if(j(n)&&!m(e)&&!k(e))throw Error("Only element or decorator nodes can be inserted in to the root node")}function tl(t){const e=t.theme,n=document.createElement("div");n.contentEditable="false",n.setAttribute("data-lexical-cursor","true");let r=e.blockCursor;if(r!==void 0){if(typeof r=="string"){const o=r.split(" ");r=e.blockCursor=o}r!==void 0&&n.classList.add(...r)}return n}function co(t){return(k(t)||m(t)&&!t.canBeEmpty())&&!t.isInline()}function fo(t,e,n){n.style.removeProperty("caret-color"),e._blockCursorElement=null;const r=t.parentElement;r!==null&&r.removeChild(t)}function nl(t,e,n){let r=t._blockCursorElement;if(M(n)&&n.isCollapsed()&&n.anchor.type==="element"&&e.contains(document.activeElement)){const o=n.anchor,s=o.getNode(),i=o.offset,a=s.getChildrenSize();let l=!1,c=null;if(i===a){const f=s.getChildAtIndex(i-1);co(f)&&(l=!0)}else{const f=s.getChildAtIndex(i);if(co(f)){const h=f.getPreviousSibling();(h===null||co(h))&&(l=!0,c=t.getElementByKey(f.__key))}}if(l){const f=t.getElementByKey(s.__key);r===null&&(t._blockCursorElement=r=tl(t._config)),e.style.caretColor="transparent",c===null?f.appendChild(r):f.insertBefore(r,c);return}}r!==null&&fo(r,t,e)}function ee(t){return oe?(t||window).getSelection():null}function ws(t,e){let n=t.getChildAtIndex(e);if(n==null&&(n=t),Z(t))throw Error("Can not call $splitNode() on root element");const r=i=>{const a=i.getParentOrThrow(),l=Z(a),c=i===n&&!l?i:Ds(i);if(l)return i.insertAfter(c),[i,c,c];{const[f,h,u]=r(a),d=i.getNextSiblings();return u.append(c,...d),[f,h,c]}},[o,s]=r(n);return[o,s]}function As(t,e){let n=t;for(;n!==ie()&&n!=null;){if(e(n))return n;n=n.getParent()}return null}function rl(t){const e=[],n=[t];for(;n.length>0;){const r=n.pop();if(r===void 0)throw Error("Stack.length > 0; can't be undefined");m(r)&&n.unshift(...r.getChildren()),r!==t&&e.push(r)}return e}function ol(t,e){const n=t._decorators;let o=t._pendingDecorators||n;const s=e._nodeMap;let i;for(i in o)s.has(i)||(o===n&&(o=_s(t)),delete o[i])}function Ps(t,e,n,r,o){let s=t.getFirstChild();for(;s!==null;){const i=s.__key;s!==void 0&&s.__parent===e&&(m(s)&&Ps(s,i,n,r,o),n.has(i)||o.delete(i),r.delete(i)),s=s.isAttached()?s.getNextSibling():null}}function sl(t,e,n,r){const o=t._nodeMap,s=e._nodeMap;for(const i of n){const a=s.get(i);a!==void 0&&!a.isAttached()&&(o.has(i)||n.delete(i),s.delete(i))}for(const[i]of r){const a=s.get(i);a!==void 0&&(a.isAttached()||(m(a)&&Ps(a,i,o,s,r),o.has(i)||r.delete(i),s.delete(i)))}}function ks(t,e){const n=t.__mode,r=t.__format,o=t.__style,s=e.__mode,i=e.__format,a=e.__style;return(n===null||n===s)&&(r===null||r===i)&&(o===null||o===a)}function Is(t,e){const n=t.mergeWithSibling(e),r=I()._normalizedNodes;return r.add(t.__key),r.add(e.__key),n}function Rs(t){let e=t;if(e.__text===""&&e.isSimpleText()&&!e.isUnmergeable()){e.remove();return}let n;for(;(n=e.getPreviousSibling())!==null&&E(n)&&n.isSimpleText()&&!n.isUnmergeable();)if(n.__text==="")n.remove();else if(ks(n,e)){e=Is(n,e);break}else break;let r;for(;(r=e.getNextSibling())!==null&&E(r)&&r.isSimpleText()&&!r.isUnmergeable();)if(r.__text==="")r.remove();else if(ks(e,r)){e=Is(e,r);break}else break}function Ls(t){return Fs(t.anchor),Fs(t.focus),t}function Fs(t){for(;t.type==="element";){const e=t.getNode(),n=t.offset;let r,o;if(n===e.getChildrenSize()?(r=e.getChildAtIndex(n-1),o=!0):(r=e.getChildAtIndex(n),o=!1),E(r)){t.set(r.__key,o?r.getTextContentSize():0,"text");break}else if(!m(r))break;t.set(r.__key,o?r.getChildrenSize():0,"element")}}let R="",Y="",ae="",ue,H,Je,Ks=!1,uo=!1,yt,xt=null,ho,$o,xe,he,go,je;function mt(t,e){const n=xe.get(t);if(e!==null){const r=yo(t);r.parentNode===e&&e.removeChild(r)}if(he.has(t)||H._keyToDOMMap.delete(t),m(n)){const r=Tt(n,xe);po(r,0,r.length-1,null)}n!==void 0&&io(je,Je,yt,n,"destroyed")}function po(t,e,n,r){let o=e;for(;o<=n;++o){const s=t[o];s!==void 0&&mt(s,r)}}function me(t,e){t.setProperty("text-align",e)}const il="20px";function Bs(t,e){const n=ue.theme.indent;if(typeof n=="string"){const o=t.classList.contains(n);e>0&&!o?t.classList.add(n):e<1&&o&&t.classList.remove(n)}const r=getComputedStyle(t).getPropertyValue("--lexical-indent-base-value")||il;t.style.setProperty("padding-inline-start",e===0?"":`calc(${e} * ${r})`)}function zs(t,e){const n=t.style;e===0?me(n,""):e===Vr?me(n,"left"):e===Jr?me(n,"center"):e===jr?me(n,"right"):e===Xr?me(n,"justify"):e===qr?me(n,"start"):e===Qr&&me(n,"end")}function Nt(t,e,n){const r=he.get(t);if(r===void 0)throw Error("createNode: node does not exist in nodeMap");const o=r.createDOM(ue,H);if(hl(t,o,H),E(r)?o.setAttribute("data-lexical-text","true"):k(r)&&o.setAttribute("data-lexical-decorator","true"),m(r)){const s=r.__indent,i=r.__size;if(s!==0&&Bs(o,s),i!==0){const l=i-1,c=Tt(r,he);al(c,l,r,o)}const a=r.__format;a!==0&&zs(o,a),r.isInline()||Us(null,r,o),ht(r)&&(R+=se,ae+=se)}else{const s=r.getTextContent();if(k(r)){const i=r.decorate(H,ue);i!==null&&Ys(t,i),o.contentEditable="false"}else E(r)&&(r.isDirectionless()||(Y+=s));R+=s,ae+=s}if(e!==null)if(n!=null)e.insertBefore(o,n);else{const s=e.__lexicalLineBreak;s!=null?e.insertBefore(o,s):e.appendChild(o)}return Object.freeze(r),io(je,Je,yt,r,"created"),o}function al(t,e,n,r){const o=Y;Y="",_o(t,n,0,e,r,null),Gs(n,r),Y=o}function _o(t,e,n,r,o,s){const i=R;R="";let a=n;for(;a<=r;++a)Nt(t[a],o,s);ht(e)&&(R+=se),o.__lexicalTextContent=R,R=i+R}function Ws(t,e){const n=e.get(t);return ot(n)||k(n)&&n.isInline()}function Us(t,e,n){const r=t!==null&&(t.__size===0||Ws(t.__last,xe)),o=e.__size===0||Ws(e.__last,he);if(r){if(!o){const s=n.__lexicalLineBreak;s!=null&&n.removeChild(s),n.__lexicalLineBreak=null}}else if(o){const s=document.createElement("br");n.__lexicalLineBreak=s,n.appendChild(s)}}function Gs(t,e){const n=e.__lexicalDirTextContent,r=e.__lexicalDir;if(n!==Y||r!==xt){const o=Y==="",s=o?xt:ua(Y);if(s!==r){const i=e.classList,a=ue.theme;let l=r!==null?a[r]:void 0,c=s!==null?a[s]:void 0;if(l!==void 0){if(typeof l=="string"){const f=l.split(" ");l=a[r]=f}i.remove(...l)}if(s===null||o&&s==="ltr")e.removeAttribute("dir");else{if(c!==void 0){if(typeof c=="string"){const f=c.split(" ");c=a[s]=f}c!==void 0&&i.add(...c)}e.dir=s}if(!uo){const f=t.getWritable();f.__dir=s}}xt=s,e.__lexicalDirTextContent=Y,e.__lexicalDir=s}}function ll(t,e,n){const r=Y;Y="",cl(t,e,n),Gs(e,n),Y=r}function Tt(t,e){const n=[];let r=t.__first;for(;r!==null;){const o=e.get(r);if(o===void 0)throw Error("createChildrenArray: node does not exist in nodeMap");n.push(r),r=o.__next}return n}function cl(t,e,n){const r=R,o=t.__size,s=e.__size;if(R="",o===1&&s===1){const i=t.__first,a=e.__first;if(i===a)Xe(i,n);else{const l=yo(i),c=Nt(a,null,null);n.replaceChild(c,l),mt(i,null)}}else{const i=Tt(t,xe),a=Tt(e,he);if(o===0)s!==0&&_o(a,e,0,s-1,n,null);else if(s===0){if(o!==0){const c=n.__lexicalLineBreak==null;po(i,0,o-1,c?null:n),c&&(n.textContent="")}}else dl(e,i,a,o,s,n)}ht(e)&&(R+=se),n.__lexicalTextContent=R,R=r+R}function Xe(t,e){const n=xe.get(t);let r=he.get(t);if(n===void 0||r===void 0)throw Error("reconcileNode: prevNode or nextNode does not exist in nodeMap");const o=Ks||$o.has(t)||ho.has(t),s=$t(H,t);if(n===r&&!o){if(m(n)){const i=s.__lexicalTextContent;i!==void 0&&(R+=i,ae+=i);const a=s.__lexicalDirTextContent;a!==void 0&&(Y+=a)}else{const i=n.getTextContent();E(n)&&!n.isDirectionless()&&(Y+=i),ae+=i,R+=i}return s}if(n!==r&&o&&io(je,Je,yt,r,"updated"),r.updateDOM(n,s,ue)){const i=Nt(t,null,null);if(e===null)throw Error("reconcileNode: parentDOM is null");return e.replaceChild(i,s),mt(t,null),i}if(m(n)&&m(r)){const i=r.__indent;i!==n.__indent&&Bs(s,i);const a=r.__format;a!==n.__format&&zs(s,a),o&&(ll(n,r,s),!j(r)&&!r.isInline()&&Us(n,r,s)),ht(r)&&(R+=se,ae+=se)}else{const i=r.getTextContent();if(k(r)){const a=r.decorate(H,ue);a!==null&&Ys(t,a)}else E(r)&&!r.isDirectionless()&&(Y+=i);R+=i,ae+=i}return!uo&&j(r)&&r.__cachedText!==ae&&(r=r.getWritable(),r.__cachedText=ae),Object.freeze(r),s}function Ys(t,e){let n=H._pendingDecorators;const r=H._decorators;if(n===null){if(r[t]===e)return;n=_s(H)}n[t]=e}function fl(t){return t.firstChild}function vo(t){let e=t.nextSibling;return e!==null&&e===H._blockCursorElement&&(e=e.nextSibling),e}function dl(t,e,n,r,o,s){const i=r-1,a=o-1;let l,c,f=fl(s),h=0,u=0;for(;h<=i&&u<=a;){const $=e[h],p=n[u];if($===p)f=vo(Xe(p,s)),h++,u++;else{l===void 0&&(l=new Set(e)),c===void 0&&(c=new Set(n));const N=c.has($),_=l.has(p);if(!N)f=vo(yo($)),mt($,s),h++;else if(!_)Nt(p,s,f),u++;else{const x=$t(H,p);x===f?f=vo(Xe(p,s)):(f!=null?s.insertBefore(x,f):s.appendChild(x),Xe(p,s)),h++,u++}}}const d=h>i,g=u>a;if(d&&!g){const $=n[a+1],p=$===void 0?null:H.getElementByKey($);_o(n,t,u,a,s,p)}else g&&!d&&po(e,h,i,s)}function ul(t,e,n,r,o,s){R="",ae="",Y="",Ks=r===Oe,xt=null,H=n,ue=n._config,Je=n._nodes,yt=H._listeners.mutation,ho=o,$o=s,xe=t._nodeMap,he=e._nodeMap,uo=e._readOnly,go=new Map(n._keyToDOMMap);const i=new Map;return je=i,Xe("root",null),H=void 0,Je=void 0,ho=void 0,$o=void 0,xe=void 0,he=void 0,ue=void 0,go=void 0,je=void 0,i}function hl(t,e,n){const r=n._keyToDOMMap;e["__lexicalKey_"+n._key]=t,r.set(t,e)}function yo(t){const e=go.get(t);if(e===void 0)throw Error(`Reconciliation: could not find DOM element for node key ${t}`);return e}const le=Object.freeze({}),xo=30,mo=[["keydown",Nl],["pointerdown",gl],["compositionstart",xl],["compositionend",ml],["input",yl],["click",$l],["cut",le],["copy",le],["dragstart",le],["dragover",le],["dragend",le],["paste",le],["focus",le],["blur",le],["drop",le]];it&&mo.push(["beforeinput",(t,e)=>vl(t,e)]);let qe=0,Hs=0,Vs=0,Me=null,Qe=0,No=!1,To=!1,Ze=!1,et=!1,Js=[0,"",0,"root",0];function js(t,e,n,r,o){const s=t.anchor,i=t.focus,a=s.getNode(),l=I(),c=ee(l._window),f=c!==null?c.anchorNode:null,h=s.key,u=l.getElementByKey(h),d=n.length;return h!==i.key||!E(a)||(!o&&(!it||Vs<r+50)||a.isDirty()&&d<2||ms(n))&&s.offset!==i.offset&&!a.isComposing()||no(a)||a.isDirty()&&d>1||(o||!it)&&u!==null&&!a.isComposing()&&f!==ft(u)||c!==null&&e!==null&&(!e.collapsed||e.startContainer!==c.anchorNode||e.startOffset!==c.anchorOffset)||a.getFormat()!==t.format||a.getStyle()!==t.style||xa(t,a)}function Xs(t,e){return t!==null&&t.nodeValue!==null&&t.nodeType===We&&e!==0&&e!==t.nodeValue.length}function qs(t,e,n){const{anchorNode:r,anchorOffset:o,focusNode:s,focusOffset:i}=t;No&&(No=!1,Xs(r,o)&&Xs(s,i))||X(e,()=>{if(!n){de(null);return}if(!Ue(e,r,s))return;const a=P();if(M(a)){const l=a.anchor,c=l.getNode();if(a.isCollapsed()){t.type==="Range"&&t.anchorNode===t.focusNode&&(a.dirty=!0);const f=_t(e).event,h=f?f.timeStamp:performance.now(),[u,d,g,$,p]=Js;h<p+200&&l.offset===g&&l.key===$?(a.format=u,a.style=d):l.type==="text"?(a.format=c.getFormat(),a.style=c.getStyle()):l.type==="element"&&(a.format=0,a.style="")}else{let f=Yi,h=!1;const u=a.getNodes(),d=u.length;for(let g=0;g<d;g++){const $=u[g];if(E($)&&(h=!0,f&=$.getFormat(),f===0))break}a.format=h?f:0}}T(e,Sr,void 0)})}function $l(t,e){X(e,()=>{const n=P(),r=ee(e._window),o=nt();if(M(n)){const s=n.anchor,i=s.getNode();r&&s.type==="element"&&s.offset===0&&n.isCollapsed()&&!j(i)&&ie().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&o!==null&&n.is(o)&&(r.removeAllRanges(),n.dirty=!0)}T(e,Io,t)})}function gl(t,e){const n=t.target,r=t.pointerType;n instanceof Node&&r!=="touch"&&X(e,()=>{da(n)||(To=!0)})}function Qs(t){if(!t.getTargetRanges)return null;const e=t.getTargetRanges();return e.length===0?null:e[0]}function pl(t,e){return t!==e||m(t)||m(e)||!t.isToken()||!e.isToken()}function _l(t){return Hs===229&&t<qe+xo}function vl(t,e){const n=t.inputType,r=Qs(t);n==="deleteCompositionText"||pe&&bs(e)||n!=="insertCompositionText"&&X(e,()=>{const o=P();if(n==="deleteContentBackward"){if(o===null){const f=nt();if(!M(f))return;de(f.clone())}if(M(o)){if(_l(t.timeStamp)&&e.isComposing()&&o.anchor.key===o.focus.key){if(z(null),qe=0,setTimeout(()=>{X(e,()=>{z(null)})},xo),M(o)){const f=o.anchor.getNode();f.markDirty(),o.format=f.getFormat(),o.style=f.getStyle()}}else t.preventDefault(),T(e,Fe,!0);return}}if(!M(o))return;const s=t.data;Me!==null&&oo(!1,e,Me),(!o.dirty||Me!==null)&&o.isCollapsed()&&!j(o.anchor.getNode())&&r!==null&&o.applyDOMRange(r),Me=null;const i=o.anchor,a=o.focus,l=i.getNode(),c=a.getNode();if(n==="insertText"||n==="insertTranspose"){if(s===`
`)t.preventDefault(),T(e,Ke,!1);else if(s===se)t.preventDefault(),T(e,Or,void 0);else if(s==null&&t.dataTransfer){const f=t.dataTransfer.getData("text/plain");t.preventDefault(),o.insertRawText(f)}else s!=null&&js(o,r,s,t.timeStamp,!0)?(t.preventDefault(),T(e,Se,s)):Me=s;Vs=t.timeStamp;return}switch(t.preventDefault(),n){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":T(e,Se,t);break;case"insertFromComposition":z(null),T(e,Se,t);break;case"insertLineBreak":z(null),T(e,Ke,!1);break;case"insertParagraph":z(null),Ze?(Ze=!1,T(e,Ke,!1)):T(e,Or,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":T(e,br,t);break;case"deleteByComposition":pl(l,c)&&T(e,Mr,void 0);break;case"deleteByDrag":case"deleteByCut":T(e,Mr,void 0);break;case"deleteContent":T(e,Fe,!1);break;case"deleteWordBackward":T(e,Be,!0);break;case"deleteWordForward":T(e,Be,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":T(e,ze,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":T(e,ze,!1);break;case"formatStrikeThrough":T(e,ce,"strikethrough");break;case"formatBold":T(e,ce,"bold");break;case"formatItalic":T(e,ce,"italic");break;case"formatUnderline":T(e,ce,"underline");break;case"historyUndo":T(e,Dr,void 0);break;case"historyRedo":T(e,wr,void 0);break}})}function yl(t,e){t.stopPropagation(),X(e,()=>{const n=P(),r=t.data,o=Qs(t);if(r!=null&&M(n)&&js(n,o,r,t.timeStamp,!1)){et&&(Eo(e,r),et=!1);const s=n.anchor,i=s.getNode(),a=ee(e._window);if(a===null)return;const l=s.offset;(!it||n.isCollapsed()||!E(i)||a.anchorNode===null||i.getTextContent().slice(0,l)+r+i.getTextContent().slice(l+n.focus.offset)!==Ts(a.anchorNode))&&T(e,Se,r);const c=r.length;pe&&c>1&&t.inputType==="insertCompositionText"&&!e.isComposing()&&(n.anchor.offset-=c),!kr&&!Ir&&!Rr&&e.isComposing()&&(qe=0,z(null))}else oo(!1,e,r!==null?r:void 0),et&&(Eo(e,r||void 0),et=!1);_a()}),Me=null}function xl(t,e){X(e,()=>{const n=P();if(M(n)&&!e.isComposing()){const r=n.anchor,o=n.anchor.getNode();z(r.key),(t.timeStamp<qe+xo||r.type==="element"||!n.isCollapsed()||o.getFormat()!==n.format||o.getStyle()!==n.style)&&T(e,Se,Vi)}})}function Eo(t,e){const n=t._compositionKey;if(z(null),n!==null&&e!=null){if(e===""){const r=F(n),o=ft(t.getElementByKey(n));o!==null&&o.nodeValue!==null&&E(r)&&so(r,o.nodeValue,null,null,!0);return}if(e[e.length-1]===`
`){const r=P();if(M(r)){const o=r.focus;r.anchor.set(o.key,o.offset,o.type),T(t,st,null);return}}}oo(!0,t,e)}function ml(t,e){pe?et=!0:X(e,()=>{Eo(e,t.data)})}function Nl(t,e){if(qe=t.timeStamp,Hs=t.keyCode,e.isComposing())return;const{keyCode:n,shiftKey:r,ctrlKey:o,metaKey:s,altKey:i}=t;if(!T(e,Ro,t)){if(Wa(n,o,i,s))T(e,Lo,t);else if(Ua(n,o,r,i,s))T(e,Fo,t);else if(Ba(n,o,i,s))T(e,Ko,t);else if(za(n,o,r,i,s))T(e,Bo,t);else if(Ga(n,o,s))T(e,zo,t);else if(Ya(n,o,s))T(e,Wo,t);else if(Sa(n,r))Ze=!0,T(e,st,t);else if(Va(n))T(e,Uo,t);else if(Oa(n,o))t.preventDefault(),Ze=!0,T(e,Ke,!0);else if(Ca(n,r))Ze=!1,T(e,st,t);else if(Aa(n,i,s,o))Ye(n)?T(e,Go,t):(t.preventDefault(),T(e,Fe,!0));else if(Ja(n))T(e,Yo,t);else if(Pa(n,o,r,i,s))He(n)?T(e,Ho,t):(t.preventDefault(),T(e,Fe,!1));else if(ba(n,i,o))t.preventDefault(),T(e,Be,!0);else if(Ma(n,i,o))t.preventDefault(),T(e,Be,!1);else if(Da(n,s))t.preventDefault(),T(e,ze,!0);else if(wa(n,s))t.preventDefault(),T(e,ze,!1);else if(Na(n,i,s,o))t.preventDefault(),T(e,ce,"bold");else if(Ea(n,i,s,o))t.preventDefault(),T(e,ce,"underline");else if(Ta(n,i,s,o))t.preventDefault(),T(e,ce,"italic");else if(ma(n,i,o,s))T(e,Vo,t);else if(ka(n,r,s,o))t.preventDefault(),T(e,Dr,void 0);else if(Ia(n,r,s,o))t.preventDefault(),T(e,wr,void 0);else{const a=e._editorState._selection;tt(a)&&(Ra(n,r,s,o)?(t.preventDefault(),T(e,Ar,t)):La(n,r,s,o)&&(t.preventDefault(),T(e,Pr,t)))}Ha(o,r,i,s)&&T(e,es,t)}}function Zs(t){let e=t.__lexicalEventHandles;return e===void 0&&(e=[],t.__lexicalEventHandles=e),e}const De=new Map;function ei(t){const e=t.target,n=e==null?null:e.nodeType===9?e.defaultView:e.ownerDocument.defaultView,r=ee(n);if(r===null)return;const o=us(r.anchorNode);if(o===null)return;To&&(To=!1,X(o,()=>{const f=nt(),h=r.anchorNode;if(h===null)return;const u=h.nodeType;if(u!==ts&&u!==We)return;const d=hi(f,r,o);de(d)}));const s=ro(o),i=s[s.length-1],a=i._key,l=De.get(a),c=l||i;c!==o&&qs(r,c,!1),qs(r,o,!0),o!==i?De.set(a,o):l&&De.delete(a)}function ti(t){t._lexicalHandled=!0}function ni(t){return t._lexicalHandled===!0}function Tl(t,e){Qe===0&&t.ownerDocument.addEventListener("selectionchange",ei),Qe++,t.__lexicalEditor=e;const n=Zs(t);for(let r=0;r<mo.length;r++){const[o,s]=mo[r],i=typeof s=="function"?a=>{ni(a)||(ti(a),e.isEditable()&&s(a,e))}:a=>{if(!ni(a)&&(ti(a),e.isEditable()))switch(o){case"cut":return T(e,Pr,a);case"copy":return T(e,Ar,a);case"paste":return T(e,br,a);case"dragstart":return T(e,jo,a);case"dragover":return T(e,Xo,a);case"dragend":return T(e,qo,a);case"focus":return T(e,Qo,a);case"blur":return T(e,Zo,a);case"drop":return T(e,Jo,a)}};t.addEventListener(o,i),n.push(()=>{t.removeEventListener(o,i)})}}function El(t){Qe!==0&&(Qe--,Qe===0&&t.ownerDocument.removeEventListener("selectionchange",ei));const e=t.__lexicalEditor;e!=null&&(Cl(e),t.__lexicalEditor=null);const n=Zs(t);for(let r=0;r<n.length;r++)n[r]();t.__lexicalEventHandles=[]}function Cl(t){if(t._parentEditor!==null){const e=ro(t),r=e[e.length-1]._key;De.get(r)===t&&De.delete(r)}else De.delete(t._key)}function Sl(){No=!0}function Ol(t,e,n,r,o){Js=[t,e,n,r,o]}class bl{is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){let n=this.getNode(),r=e.getNode();const o=this.offset,s=e.offset;if(m(n)){const i=n.getDescendantByIndex(o);n=i??n}if(m(r)){const i=r.getDescendantByIndex(s);r=i??r}return n===r?o<s:n.isBefore(r)}getNode(){const e=this.key,n=F(e);if(n===null)throw Error("Point.getNode: node not found");return n}set(e,n,r){const o=this._selection,s=this.key;this.key=e,this.offset=n,this.type=r,we()||(fe()===s&&z(e),o!==null&&(o._cachedNodes=null,o.dirty=!0))}constructor(e,n,r){this._selection=null,this.key=e,this.offset=n,this.type=r}}function te(t,e,n){return new bl(t,e,n)}function Co(t,e){let n=e.__key,r=t.offset,o="element";if(E(e)){o="text";const s=e.getTextContentSize();r>s&&(r=s)}else if(!m(e)){const s=e.getNextSibling();if(E(s))n=s.__key,r=0,o="text";else{const i=e.getParent();i&&(n=i.__key,r=e.getIndexWithinParent()+1)}}t.set(n,r,o)}function ri(t,e){if(m(e)){const n=e.getLastDescendant();m(n)||E(n)?Co(t,n):Co(t,e)}else Co(t,e)}function oi(t,e,n,r){const o=t.getNode(),s=o.getChildAtIndex(t.offset),i=W(),a=j(o)?Ce().append(i):i;i.setFormat(n),i.setStyle(r),s===null?o.append(a):s.insertBefore(a),t.is(e)&&e.set(i.__key,0,"text"),t.set(i.__key,0,"text")}function $e(t,e,n,r){t.key=e,t.offset=n,t.type=r}class Et{is(e){if(!tt(e))return!1;const n=this._nodes,r=e._nodes;return n.size===r.size&&Array.from(n).every(o=>r.has(o))}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new Et(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e,n){const r=this.getNodes(),o=r.length,s=r[o-1];let i;if(E(s))i=s.select();else{const a=s.getIndexWithinParent()+1;i=s.getParentOrThrow().select(a,a)}i.insertNodes(e,n);for(let a=0;a<o;a++)r[a].remove();return!0}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const n=this._nodes,r=[];for(const o of n){const s=F(o);s!==null&&r.push(s)}return we()||(this._cachedNodes=r),r}getTextContent(){const e=this.getNodes();let n="";for(let r=0;r<e.length;r++)n+=e[r].getTextContent();return n}constructor(e){this.dirty=!1,this._nodes=e,this._cachedNodes=null}}function M(t){return t instanceof Ne}class Ct{is(e){return So(e)?this.gridKey===e.gridKey&&this.anchor.is(e.anchor)&&this.focus.is(e.focus):!1}set(e,n,r){this.dirty=!0,this.gridKey=e,this.anchor.key=n,this.focus.key=r,this._cachedNodes=null}clone(){return new Ct(this.gridKey,this.anchor,this.focus)}isCollapsed(){return!1}isBackward(){return this.focus.isBefore(this.anchor)}getCharacterOffsets(){return St(this)}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e,n){const r=this.focus.getNode();return Ls(r.select(0,r.getChildrenSize())).insertNodes(e,n)}getShape(){const e=F(this.anchor.key);if(e===null)throw Error("getNodes: expected to find AnchorNode");const n=e.getIndexWithinParent(),r=e.getParentOrThrow().getIndexWithinParent(),o=F(this.focus.key);if(o===null)throw Error("getNodes: expected to find FocusNode");const s=o.getIndexWithinParent(),i=o.getParentOrThrow().getIndexWithinParent(),a=Math.min(n,s),l=Math.max(n,s),c=Math.min(r,i),f=Math.max(r,i);return{fromX:Math.min(a,l),fromY:Math.min(c,f),toX:Math.max(a,l),toY:Math.max(c,f)}}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const n=this.anchor.getNode(),r=this.focus.getNode(),o=As(n,Le),s=As(r,Le);if(!Le(o))throw Error("Expected GridSelection anchor to be (or a child of) GridCellNode");if(!Le(s))throw Error("Expected GridSelection focus to be (or a child of) GridCellNode");const i=o.getParent();if(!Pt(i))throw Error("Expected anchorCell to have a parent GridRowNode");const a=i.getParent();if(!Pi(a))throw Error("Expected tableNode to have a parent GridNode");const[l,c,f]=Bl(a,o,s);let h=Math.min(c.startColumn,f.startColumn),u=Math.min(c.startRow,f.startRow),d=Math.max(c.startColumn+c.cell.__colSpan-1,f.startColumn+f.cell.__colSpan-1),g=Math.max(c.startRow+c.cell.__rowSpan-1,f.startRow+f.cell.__rowSpan-1),$=h,p=u,N=h,_=u;function x(S){const{cell:b,startColumn:w,startRow:U}=S;h=Math.min(h,w),u=Math.min(u,U),d=Math.max(d,w+b.__colSpan-1),g=Math.max(g,U+b.__rowSpan-1)}for(;h<$||u<p||d>N||g>_;){if(h<$){const S=_-p,b=$-1;for(let w=0;w<=S;w++)x(l[p+w][b]);$=b}if(u<p){const S=N-$,b=p-1;for(let w=0;w<=S;w++)x(l[b][$+w]);p=b}if(d>N){const S=_-p,b=N+1;for(let w=0;w<=S;w++)x(l[p+w][b]);N=b}if(g>_){const S=N-$,b=_+1;for(let w=0;w<=S;w++)x(l[b][$+w]);_=b}}const O=[a];let C=null;for(let S=u;S<=g;S++)for(let b=h;b<=d;b++){const{cell:w}=l[S][b],U=w.getParent();if(!Pt(U))throw Error("Expected GridCellNode parent to be a GridRowNode");U!==C&&O.push(U),O.push(w,...rl(w)),C=U}return we()||(this._cachedNodes=O),O}getTextContent(){const e=this.getNodes();let n="";for(let r=0;r<e.length;r++)n+=e[r].getTextContent();return n}constructor(e,n,r){this.gridKey=e,this.anchor=n,this.focus=r,this.dirty=!1,this._cachedNodes=null,n._selection=this,r._selection=this}}function So(t){return t instanceof Ct}class Ne{is(e){return M(e)?this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style:!1}isBackward(){return this.focus.isBefore(this.anchor)}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const n=this.anchor,r=this.focus,o=n.isBefore(r),s=o?n:r,i=o?r:n;let a=s.getNode(),l=i.getNode();const c=s.offset,f=i.offset;if(m(a)){const u=a.getDescendantByIndex(c);a=u??a}if(m(l)){let u=l.getDescendantByIndex(f);u!==null&&u!==a&&l.getChildAtIndex(f)===u&&(u=u.getPreviousSibling()),l=u??l}let h;return a.is(l)?m(a)&&a.getChildrenSize()>0?h=[]:h=[a]:h=a.getNodesBetween(l),we()||(this._cachedNodes=h),h}setTextNodeRange(e,n,r,o){$e(this.anchor,e.__key,n,"text"),$e(this.focus,r.__key,o,"text"),this._cachedNodes=null,this.dirty=!0}getTextContent(){const e=this.getNodes();if(e.length===0)return"";const n=e[0],r=e[e.length-1],o=this.anchor,s=this.focus,i=o.isBefore(s),[a,l]=St(this);let c="",f=!0;for(let h=0;h<e.length;h++){const u=e[h];if(m(u)&&!u.isInline())f||(c+=`
`),u.isEmpty()?f=!1:f=!0;else if(f=!1,E(u)){let d=u.getTextContent();u===n?u===r?(o.type!=="element"||s.type!=="element"||s.offset===o.offset)&&(d=a<l?d.slice(a,l):d.slice(l,a)):d=i?d.slice(a):d.slice(l):u===r&&(d=i?d.slice(0,l):d.slice(0,a)),c+=d}else(k(u)||ot(u))&&(u!==r||!this.isCollapsed())&&(c+=u.getTextContent())}return c}applyDOMRange(e){const n=I(),o=n.getEditorState()._selection,s=fi(e.startContainer,e.startOffset,e.endContainer,e.endOffset,n,o);if(s===null)return;const[i,a]=s;$e(this.anchor,i.key,i.offset,i.type),$e(this.focus,a.key,a.offset,a.type),this._cachedNodes=null}clone(){const e=this.anchor,n=this.focus;return new Ne(te(e.key,e.offset,e.type),te(n.key,n.offset,n.type),this.format,this.style)}toggleFormat(e){this.format=hs(this.format,e,null),this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){const n=ve[e];return(this.format&n)!=0}insertRawText(e){const n=e.split(/\r?\n/);if(n.length===1)this.insertText(e);else{const r=[],o=n.length;for(let s=0;s<o;s++){const i=n[s];i!==""&&r.push(W(i)),s!==o-1&&r.push(ke())}this.insertNodes(r)}}insertText(e){const n=this.anchor,r=this.focus,o=this.isCollapsed()||n.isBefore(r),s=this.format,i=this.style;o&&n.type==="element"?oi(n,r,s,i):!o&&r.type==="element"&&oi(r,n,s,i);const a=this.getNodes(),l=a.length,c=o?n:r,f=o?r:n,h=c.offset,u=f.offset;let d=a[0];if(!E(d))throw Error("insertText: first node is not a text node");const $=d.getTextContent().length,p=d.getParentOrThrow(),N=l-1;let _=a[N];if(this.isCollapsed()&&h===$&&(d.isSegmented()||d.isToken()||!d.canInsertTextAfter()||!p.canInsertTextAfter()&&d.getNextSibling()===null)){let x=d.getNextSibling();if((!E(x)||no(x))&&(x=W(),x.setFormat(s),p.canInsertTextAfter()?d.insertAfter(x):p.insertAfter(x)),x.select(0,0),d=x,e!==""){this.insertText(e);return}}else if(this.isCollapsed()&&h===0&&(d.isSegmented()||d.isToken()||!d.canInsertTextBefore()||!p.canInsertTextBefore()&&d.getPreviousSibling()===null)){let x=d.getPreviousSibling();if((!E(x)||no(x))&&(x=W(),x.setFormat(s),p.canInsertTextBefore()?d.insertBefore(x):p.insertBefore(x)),x.select(),d=x,e!==""){this.insertText(e);return}}else if(d.isSegmented()&&h!==$){const x=W(d.getTextContent());x.setFormat(s),d.replace(x),d=x}else if(!this.isCollapsed()&&e!==""){const x=_.getParent();if(!p.canInsertTextBefore()||!p.canInsertTextAfter()||m(x)&&(!x.canInsertTextBefore()||!x.canInsertTextAfter())){this.insertText(""),ci(this.anchor,this.focus,null),this.insertText(e);return}}if(l===1){if(d.isToken()){const S=W(e);S.select(),d.replace(S);return}const x=d.getFormat(),O=d.getStyle();if(h===u&&(x!==s||O!==i))if(d.getTextContent()==="")d.setFormat(s),d.setStyle(i);else{const S=W(e);if(S.setFormat(s),S.setStyle(i),S.select(),h===0)d.insertBefore(S,!1);else{const[b]=d.splitText(h);b.insertAfter(S,!1)}S.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length);return}const C=u-h;d=d.spliceText(h,C,e,!0),d.getTextContent()===""?d.remove():this.anchor.type==="text"&&(d.isComposing()?this.anchor.offset-=e.length:(this.format=x,this.style=O))}else{const x=new Set([...d.getParentKeys(),..._.getParentKeys()]),O=m(d)?d:d.getParentOrThrow();let C=m(_)?_:_.getParentOrThrow(),S=_;if(!O.is(C)&&C.isInline())do S=C,C=C.getParentOrThrow();while(C.isInline());if(f.type==="text"&&(u!==0||_.getTextContent()==="")||f.type==="element"&&_.getIndexWithinParent()<u)if(E(_)&&!_.isToken()&&u!==_.getTextContentSize()){if(_.isSegmented()){const A=W(_.getTextContent());_.replace(A),_=A}_=_.spliceText(0,u,""),x.add(_.__key)}else{const A=_.getParentOrThrow();!A.canBeEmpty()&&A.getChildrenSize()===1?A.remove():_.remove()}else x.add(_.__key);const b=C.getChildren(),w=new Set(a),U=O.is(C),V=O.isInline()&&d.getNextSibling()===null?O:d;for(let A=b.length-1;A>=0;A--){const L=b[A];if(L.is(d)||m(L)&&L.isParentOf(d))break;L.isAttached()&&(!w.has(L)||L.is(S)?U||V.insertAfter(L,!1):L.remove())}if(!U){let A=C,L=null;for(;A!==null;){const q=A.getChildren(),re=q.length;(re===0||q[re-1].is(L))&&(x.delete(A.__key),L=A),A=A.getParent()}}if(!d.isToken())d=d.spliceText(h,$-h,e,!0),d.getTextContent()===""?d.remove():d.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length);else if(h===$)d.select();else{const A=W(e);A.select(),d.replace(A)}for(let A=1;A<l;A++){const L=a[A],q=L.__key;x.has(q)||L.remove()}}}removeText(){this.insertText("")}formatText(e){if(this.isCollapsed()){this.toggleFormat(e),z(null);return}const n=this.getNodes(),r=[];for(const _ of n)E(_)&&r.push(_);const o=r.length;if(o===0){this.toggleFormat(e),z(null);return}const s=this.anchor,i=this.focus,a=this.isBackward(),l=a?i:s,c=a?s:i;let f=0,h=r[0],u=l.type==="element"?0:l.offset;if(l.type==="text"&&u===h.getTextContentSize()&&(f=1,h=r[1],u=0),h==null)return;const d=h.getFormatFlags(e,null),g=o-1;let $=r[g];const p=c.type==="text"?c.offset:$.getTextContentSize();if(h.is($)){if(u===p)return;if(u===0&&p===h.getTextContentSize())h.setFormat(d);else{const _=h.splitText(u,p),x=u===0?_[0]:_[1];x.setFormat(d),l.type==="text"&&l.set(x.__key,0,"text"),c.type==="text"&&c.set(x.__key,p-u,"text")}this.format=d;return}u!==0&&([,h]=h.splitText(u),u=0),h.setFormat(d);const N=$.getFormatFlags(e,d);p>0&&(p!==$.getTextContentSize()&&([$]=$.splitText(p)),$.setFormat(N));for(let _=f+1;_<g;_++){const x=r[_];if(!x.isToken()){const O=x.getFormatFlags(e,N);x.setFormat(O)}}l.type==="text"&&l.set(h.__key,u,"text"),c.type==="text"&&c.set($.__key,p,"text"),this.format=d|N}insertNodes(e,n){if(!this.isCollapsed()){const g=this.isBackward()?this.anchor:this.focus,$=g.getNode().getNextSibling(),p=$?$.getKey():null,N=g.getNode().getPreviousSibling(),_=N?N.getKey():null;if(this.removeText(),this.isCollapsed()&&this.focus.type==="element"){let x;this.focus.key===p&&this.focus.offset===0?(x=W(),this.focus.getNode().insertBefore(x)):this.focus.key===_&&this.focus.offset===this.focus.getNode().getChildrenSize()&&(x=W(),this.focus.getNode().insertAfter(x)),x&&(this.focus.set(x.__key,0,"text"),this.anchor.set(x.__key,0,"text"))}}const r=this.anchor,o=r.offset,s=r.getNode();let i=s;if(r.type==="element"){const g=r.getNode(),$=g.getChildAtIndex(o-1);$===null?i=g:i=$}const a=[],l=s.getNextSiblings(),c=Z(s)?null:s.getTopLevelElementOrThrow();if(E(s)){const $=s.getTextContent().length;if(o===0&&$!==0){const p=s.getPreviousSibling();p!==null?i=p:i=s.getParentOrThrow(),a.push(s)}else if(o===$)i=s;else{if(s.isToken())return!1;{let p;[i,p]=s.splitText(o),a.push(p)}}}const f=i;a.push(...l);const h=e[0];let u=!1,d=null;for(let g=0;g<e.length;g++){const $=e[g];if(!Z(i)&&!k(i)&&m($)&&!$.isInline()){if($.is(h)){if(m(i)&&i.isEmpty()&&i.canReplaceWith($)){i.replace($),i=$,u=!0;continue}const p=$.getFirstDescendant();if($s(p)){let N=p.getParentOrThrow();for(;N.isInline();)N=N.getParentOrThrow();const _=N.getChildren(),x=_.length;if(m(i)){let O=i.getFirstChild();for(let C=0;C<x;C++){const S=_[C];O===null?i.append(S):O.insertAfter(S),O=S}}else{for(let O=x-1;O>=0;O--)i.insertAfter(_[O]);i=i.getParentOrThrow()}if(d=_[x-1],N.remove(),u=!0,N.is($))continue}}if(E(i)){if(c===null)throw Error("insertNode: topLevelElement is root node");i=c}}else if(u&&!k($)&&Z(i.getParent()))throw Error("insertNodes: cannot insert a non-element into a root node");if(u=!1,m(i)&&!i.isInline())if(d=$,k($)&&!$.isInline())i=i.insertAfter($,!1);else if(m($)){if(!$.canBeEmpty()&&$.isEmpty())continue;if(j(i)){const p=i.getChildAtIndex(o);p!==null?p.insertBefore($):i.append($),i=$}else $.isInline()?(i.append($),i=$):i=i.insertAfter($,!1)}else{const p=i.getFirstChild();p!==null?p.insertBefore($):i.append($),i=$}else if(!m($)||m($)&&$.isInline()||k(i)&&!i.isInline())if(d=$,M(this)&&k($)&&(m(i)||E(i))&&!$.isInline()){let p,N;if(E(i)){p=i.getParentOrThrow();const[x]=i.splitText(o);N=x.getIndexWithinParent()+1}else p=i,N=o;const[,_]=ws(p,N);i=_.insertBefore($)}else i=i.insertAfter($,!1);else{const p=i.getParentOrThrow();ot(i)&&i.remove(),i=p,g--;continue}}if(n)if(E(f))f.select();else{const g=i.getPreviousSibling();if(E(g))g.select();else{const $=i.getIndexWithinParent();i.getParentOrThrow().select($,$)}}if(m(i)){const g=E(d)?d:m(d)&&d.isInline()?d.getLastDescendant():i.getLastDescendant();if(n||(g===null?i.select():E(g)?g.getTextContent()===""?g.selectPrevious():g.select():g.selectNext()),a.length!==0){const $=i;for(let p=a.length-1;p>=0;p--){const N=a[p],_=N.getParentOrThrow();if(m(i)&&!di(N)&&!(k(N)&&(!N.isInline()||N.isIsolated())))$===i?i.append(N):i.insertBefore(N),i=N;else if(!m(i)&&!di(N))i.insertBefore(N),i=N;else if(m(N)&&!N.canInsertAfter(i)){const x=_.constructor.clone(_);if(!m(x))throw Error("insertNodes: cloned parent clone is not an element");x.append(N),i.insertAfter(x)}else i.insertAfter(N);_.isEmpty()&&!_.canBeEmpty()&&_.remove()}}}else if(!n)if(E(i))i.select();else{const g=i.getParentOrThrow(),$=i.getIndexWithinParent()+1;g.select($,$)}return!0}insertParagraph(){this.isCollapsed()||this.removeText();const e=this.anchor,n=e.offset;let r,o=[],s=[];if(e.type==="text"){const l=e.getNode();o=l.getNextSiblings().reverse(),r=l.getParentOrThrow();const c=r.isInline(),f=c?r.getTextContentSize():l.getTextContentSize();if(n===0)o.push(l);else if(c&&(s=r.getNextSiblings()),n!==f&&(!c||n!==l.getTextContentSize())){const[,h]=l.splitText(n);o.push(h)}}else{if(r=e.getNode(),Z(r)){const l=Ce(),c=r.getChildAtIndex(n);l.select(),c!==null?c.insertBefore(l,!1):r.append(l);return}o=r.getChildren().slice(n).reverse()}const i=o.length;if(n===0&&i>0&&r.isInline()){const l=r.getParentOrThrow(),c=l.insertNewAfter(this,!1);if(m(c)){const f=l.getChildren();for(let h=0;h<f.length;h++)c.append(f[h])}return}const a=r.insertNewAfter(this,!1);if(a===null)this.insertLineBreak();else if(m(a)){const l=r.getFirstChild();if(n===0&&(r.is(e.getNode())||l&&l.is(e.getNode()))&&i>0){r.insertBefore(a);return}let f=null;const h=s.length,u=a.getParentOrThrow();if(h>0)for(let d=0;d<h;d++){const g=s[d];u.append(g)}if(i!==0)for(let d=0;d<i;d++){const g=o[d];f===null?a.append(g):f.insertBefore(g),f=g}!a.canBeEmpty()&&a.getChildrenSize()===0?(a.selectPrevious(),a.remove()):a.selectStart()}}insertLineBreak(e){const n=ke(),r=this.anchor;if(r.type==="element"){const o=r.getNode();j(o)&&this.insertParagraph()}e?this.insertNodes([n],!0):this.insertNodes([n])&&n.selectNext(0,0)}getCharacterOffsets(){return St(this)}extract(){const e=this.getNodes(),n=e.length,r=n-1,o=this.anchor,s=this.focus;let i=e[0],a=e[r];const[l,c]=St(this);if(n===0)return[];if(n===1){if(E(i)&&!this.isCollapsed()){const h=l>c?c:l,u=l>c?l:c,d=i.splitText(h,u),g=h===0?d[0]:d[1];return g!=null?[g]:[]}return[i]}const f=o.isBefore(s);if(E(i)){const h=f?l:c;h===i.getTextContentSize()?e.shift():h!==0&&([,i]=i.splitText(h),e[0]=i)}if(E(a)){const u=a.getTextContent().length,d=f?c:l;d===0?e.pop():d!==u&&([a]=a.splitText(d),e[r]=a)}return e}modify(e,n,r){const o=this.focus,s=this.anchor,i=e==="move",a=ao(o,n);if(k(a)&&!a.isIsolated()){if(i&&a.isKeyboardSelectable()){const d=Oo();d.add(a.__key),de(d);return}const u=n?a.getPreviousSibling():a.getNextSibling();if(E(u)){const d=u.__key,g=n?u.getTextContent().length:0;o.set(d,g,"text"),i&&s.set(d,g,"text");return}else{const d=a.getParentOrThrow();let g,$;m(u)?($=u.__key,g=n?u.getChildrenSize():0):(g=a.getIndexWithinParent(),$=d.__key,n||g++),o.set($,g,"element"),i&&s.set($,g,"element");return}}const l=I(),c=ee(l._window);if(!c)return;const f=l._blockCursorElement,h=l._rootElement;if(h!==null&&f!==null&&m(a)&&!a.isInline()&&!a.canBeEmpty()&&fo(f,l,h),Dl(c,e,n?"backward":"forward",r),c.rangeCount>0){const u=c.getRangeAt(0),d=this.anchor.getNode(),g=j(d)?d:Ms(d);if(this.applyDOMRange(u),this.dirty=!0,!i){const $=this.getNodes(),p=[];let N=!1;for(let _=0;_<$.length;_++){const x=$[_];pt(x,g)?p.push(x):N=!0}if(N&&p.length>0)if(n){const _=p[0];m(_)?_.selectStart():_.getParentOrThrow().selectStart()}else{const _=p[p.length-1];m(_)?_.selectEnd():_.getParentOrThrow().selectEnd()}(c.anchorNode!==u.startContainer||c.anchorOffset!==u.startOffset)&&Ml(this)}}}deleteCharacter(e){if(this.isCollapsed()){const r=this.anchor,o=this.focus;let s=r.getNode();if(!e&&(r.type==="element"&&m(s)&&r.offset===s.getChildrenSize()||r.type==="text"&&r.offset===s.getTextContentSize())){const a=s.getParent(),l=s.getNextSibling()||(a===null?null:a.getNextSibling());if(m(l)&&!l.canExtractContents())return}const i=ao(o,e);if(k(i)&&!i.isIsolated()){if(i.isKeyboardSelectable()&&m(s)&&s.getChildrenSize()===0){s.remove();const a=Oo();a.add(i.__key),de(a)}else i.remove();return}if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&r.offset===0&&(r.type==="element"?r.getNode():r.getNode().getParentOrThrow()).collapseAtStart(this))return}else{const a=o.type==="text"?o.getNode():null;if(s=r.type==="text"?r.getNode():null,a!==null&&a.isSegmented()){const l=o.offset,c=a.getTextContentSize();if(a.is(s)||e&&l!==c||!e&&l!==0){ii(a,e,l);return}}else if(s!==null&&s.isSegmented()){const l=r.offset,c=s.getTextContentSize();if(s.is(a)||e&&l!==0||!e&&l!==c){ii(s,e,l);return}}wl(this,e)}}const n=this.isCollapsed();if(this.removeText(),e&&!n&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const r=this.anchor.getNode();r.isEmpty()&&j(r.getParent())&&r.getIndexWithinParent()===0&&r.collapseAtStart(this)}}deleteLine(e){this.isCollapsed()&&(this.anchor.type==="text"&&this.modify("extend",e,"lineboundary"),(e?this.focus:this.anchor).offset===0&&this.modify("extend",e,"character")),this.removeText()}deleteWord(e){this.isCollapsed()&&this.modify("extend",e,"word"),this.removeText()}constructor(e,n,r,o){this.anchor=e,this.focus=n,this.dirty=!1,this.format=r,this.style=o,this._cachedNodes=null,e._selection=this,n._selection=this}}function tt(t){return t instanceof Et}function si(t){const e=t.offset;if(t.type==="text")return e;const n=t.getNode();return e===n.getChildrenSize()?n.getTextContent().length:0}function St(t){const e=t.anchor,n=t.focus;return e.type==="element"&&n.type==="element"&&e.key===n.key&&e.offset===n.offset?[0,0]:[si(e),si(n)]}function Ml(t){const e=t.focus,n=t.anchor,r=n.key,o=n.offset,s=n.type;$e(n,e.key,e.offset,e.type),$e(e,r,o,s),t._cachedNodes=null}function Dl(t,e,n,r){t.modify(e,n,r)}function wl(t,e){const n=t.anchor,r=t.focus,o=n.getNode(),s=r.getNode();if(o===s&&n.type==="text"&&r.type==="text"){const i=n.offset,a=r.offset,l=i<a,c=l?i:a,f=l?a:i,h=f-1;if(c!==h){const u=o.getTextContent().slice(c,f);ms(u)||(e?r.offset=h:n.offset=h)}}}function ii(t,e,n){const r=t,s=r.getTextContent().split(/(?=\s)/g),i=s.length;let a=0,l=0;for(let f=0;f<i;f++){const h=s[f],u=f===i-1;if(l=a,a+=h.length,e&&a===n||a>n||u){s.splice(f,1),u&&(l=void 0);break}}const c=s.join("").trim();c===""?r.remove():(r.setTextContent(c),r.select(l,l))}function Al(t,e,n){const r=t.getParent();return n===null||r===null||!r.canBeEmpty()||r!==n.getNode()}function ai(t,e,n,r){let o=e,s;if(t.nodeType===ts){let i=!1;const a=t.childNodes,l=a.length;o===l&&(i=!0,o=l-1);let c=a[o],f=!1;if(c===r._blockCursorElement?(c=a[o+1],f=!0):r._blockCursorElement!==null&&o--,s=be(c),E(s))o=xs(s,i);else{let h=be(t);if(h===null)return null;if(m(h)){let u=h.getChildAtIndex(o);if(m(u)&&Al(u,o,n)){const d=i?u.getLastDescendant():u.getFirstDescendant();d===null?(h=u,o=0):(u=d,h=m(u)?u:u.getParentOrThrow())}E(u)?(s=u,h=null,o=xs(u,i)):u!==h&&i&&!f&&o++}else{const u=h.getIndexWithinParent();e===0&&k(h)&&be(t)===h?o=u:o=u+1,h=h.getParentOrThrow()}if(m(h))return te(h.__key,o,"element")}}else s=be(t);return E(s)?te(s.__key,o,"text"):null}function li(t,e,n){const r=t.offset,o=t.getNode();if(r===0){const s=o.getPreviousSibling(),i=o.getParent();if(!e)m(s)&&!n&&s.isInline()?(t.key=s.__key,t.offset=s.getChildrenSize(),t.type="element"):E(s)&&(t.key=s.__key,t.offset=s.getTextContent().length);else if((n||!e)&&s===null&&m(i)&&i.isInline()){const a=i.getPreviousSibling();E(a)&&(t.key=a.__key,t.offset=a.getTextContent().length)}}else if(r===o.getTextContent().length){const s=o.getNextSibling(),i=o.getParent();if(e&&m(s)&&s.isInline())t.key=s.__key,t.offset=0,t.type="element";else if((n||e)&&s===null&&m(i)&&i.isInline()&&!i.canInsertTextAfter()){const a=i.getNextSibling();E(a)&&(t.key=a.__key,t.offset=0)}}}function ci(t,e,n){if(t.type==="text"&&e.type==="text"){const r=t.isBefore(e),o=t.is(e);li(t,r,o),li(e,!r,o),o&&(e.key=t.key,e.offset=t.offset,e.type=t.type);const s=I();if(s.isComposing()&&s._compositionKey!==t.key&&M(n)){const i=n.anchor,a=n.focus;$e(t,i.key,i.offset,i.type),$e(e,a.key,a.offset,a.type)}}}function fi(t,e,n,r,o,s){if(t===null||n===null||!Ue(o,t,n))return null;const i=ai(t,e,M(s)?s.anchor:null,o);if(i===null)return null;const a=ai(n,r,M(s)?s.focus:null,o);if(a===null)return null;if(i.type==="element"&&a.type==="element"){const l=be(t),c=be(n);if(k(l)&&k(c))return null}return ci(i,a,s),[i,a]}function di(t){return m(t)&&!t.isInline()}function ui(t,e,n,r,o,s){const i=ne(),a=new Ne(te(t,e,o),te(n,r,s),0,"");return a.dirty=!0,i._selection=a,a}function Pl(){const t=te("root",0,"element"),e=te("root",0,"element");return new Ne(t,e,0,"")}function Oo(){return new Et(new Set)}function kl(){const t=te("root",0,"element"),e=te("root",0,"element");return new Ct("root",t,e)}function Il(t){const n=t.getEditorState()._selection,r=ee(t._window);return tt(n)||So(n)?n.clone():hi(n,r,t)}function hi(t,e,n){const r=n._window;if(r===null)return null;const o=r.event,s=o?o.type:void 0,i=s==="selectionchange",a=!ta()&&(i||s==="beforeinput"||s==="compositionstart"||s==="compositionend"||s==="click"&&o&&o.detail===3||s==="drop"||s===void 0);let l,c,f,h;if(!M(t)||a){if(e===null)return null;if(l=e.anchorNode,c=e.focusNode,f=e.anchorOffset,h=e.focusOffset,i&&M(t)&&!Ue(n,l,c))return t.clone()}else return t.clone();const u=fi(l,f,c,h,n,t);if(u===null)return null;const[d,g]=u;return new Ne(d,g,M(t)?t.format:0,M(t)?t.style:"")}function P(){return ne()._selection}function nt(){return I()._editorState._selection}function Ot(t,e,n,r=1){const o=t.anchor,s=t.focus,i=o.getNode(),a=s.getNode();if(!e.is(i)&&!e.is(a))return;const l=e.__key;if(t.isCollapsed()){const g=o.offset;if(n<=g){const $=Math.max(0,g+r);o.set(l,$,"element"),s.set(l,$,"element"),$i(t)}return}const c=t.isBackward(),f=c?s:o,h=f.getNode(),u=c?o:s,d=u.getNode();if(e.is(h)){const g=f.offset;n<=g&&f.set(l,Math.max(0,g+r),"element")}if(e.is(d)){const g=u.offset;n<=g&&u.set(l,Math.max(0,g+r),"element")}$i(t)}function $i(t){const e=t.anchor,n=e.offset,r=t.focus,o=r.offset,s=e.getNode(),i=r.getNode();if(t.isCollapsed()){if(!m(s))return;const a=s.getChildrenSize(),l=n>=a,c=l?s.getChildAtIndex(a-1):s.getChildAtIndex(n);if(E(c)){let f=0;l&&(f=c.getTextContentSize()),e.set(c.__key,f,"text"),r.set(c.__key,f,"text")}return}if(m(s)){const a=s.getChildrenSize(),l=n>=a,c=l?s.getChildAtIndex(a-1):s.getChildAtIndex(n);if(E(c)){let f=0;l&&(f=c.getTextContentSize()),e.set(c.__key,f,"text")}}if(m(i)){const a=i.getChildrenSize(),l=o>=a,c=l?i.getChildAtIndex(a-1):i.getChildAtIndex(o);if(E(c)){let f=0;l&&(f=c.getTextContentSize()),r.set(c.__key,f,"text")}}}function Rl(t,e){const r=e.getEditorState()._selection,o=t._selection;if(M(o)){const s=o.anchor,i=o.focus;let a;if(s.type==="text"&&(a=s.getNode(),a.selectionTransform(r,o)),i.type==="text"){const l=i.getNode();a!==l&&l.selectionTransform(r,o)}}}function bt(t,e,n,r,o){let s=null,i=0,a=null;r!==null?(s=r.__key,E(r)?(i=r.getTextContentSize(),a="text"):m(r)&&(i=r.getChildrenSize(),a="element")):o!==null&&(s=o.__key,E(o)?a="text":m(o)&&(a="element")),s!==null&&a!==null?t.set(s,i,a):(i=e.getIndexWithinParent(),i===-1&&(i=n.getChildrenSize()),t.set(n.__key,i,"element"))}function gi(t,e,n,r,o){t.type==="text"?(t.key=n,e||(t.offset+=o)):t.offset>r.getIndexWithinParent()&&(t.offset-=1)}function Ll(t,e,n,r,o,s,i){const a=r.anchorNode,l=r.focusNode,c=r.anchorOffset,f=r.focusOffset,h=document.activeElement;if(o.has("collaboration")&&h!==s||h!==null&&ds(h))return;if(!M(e)){t!==null&&Ue(n,a,l)&&r.removeAllRanges();return}const u=e.anchor,d=e.focus,g=u.key,$=d.key,p=$t(n,g),N=$t(n,$),_=u.offset,x=d.offset,O=e.format,C=e.style,S=e.isCollapsed();let b=p,w=N,U=!1;if(u.type==="text"){b=ft(p);const V=u.getNode();U=V.getFormat()!==O||V.getStyle()!==C}else M(t)&&t.anchor.type==="text"&&(U=!0);if(d.type==="text"&&(w=ft(N)),!(b===null||w===null)&&(S&&(t===null||U||M(t)&&(t.format!==O||t.style!==C))&&Ol(O,C,_,g,performance.now()),!(c===_&&f===x&&a===b&&l===w&&!(r.type==="Range"&&S)&&((h===null||!s.contains(h))&&s.focus({preventScroll:!0}),u.type!=="element")))){try{r.setBaseAndExtent(b,_,w,x)}catch{}if(!o.has("skip-scroll-into-view")&&e.isCollapsed()&&s!==null&&s===document.activeElement){const V=e instanceof Ne&&e.anchor.type==="element"?b.childNodes[_]||null:r.rangeCount>0?r.getRangeAt(0):null;if(V!==null){const A=V.getBoundingClientRect();Xa(n,A,s)}}Sl()}}function Fl(t,e){let n=P();return n===null&&(n=ie().selectEnd()),n.insertNodes(t,e)}function Kl(){const t=P();return t===null?"":t.getTextContent()}function Bl(t,e,n){const r=[];let o=null,s=null;function i(c,f,h){const u={cell:h,startColumn:f,startRow:c},d=h.__rowSpan,g=h.__colSpan;for(let $=0;$<d;$++){r[c+$]===void 0&&(r[c+$]=[]);for(let p=0;p<g;p++)r[c+$][f+p]=u}e.is(h)&&(o=u),n.is(h)&&(s=u)}function a(c,f){return r[c]===void 0||r[c][f]===void 0}const l=t.getChildren();for(let c=0;c<l.length;c++){const f=l[c];if(!Pt(f))throw Error("Expected GridNode children to be GridRowNode");const h=f.getChildren();let u=0;for(const d of h){if(!Le(d))throw Error("Expected GridRowNode children to be GridCellNode");for(;!a(c,u);)u++;i(c,u,d),u+=d.__colSpan}}if(o===null)throw Error("Anchor not found in Grid");if(s===null)throw Error("Focus not found in Grid");return[r,o,s]}let K=null,B=null,J=!1,bo=!1,Mt=0;const pi={characterData:!0,childList:!0,subtree:!0};function we(){return J||K!==null&&K._readOnly}function G(){if(J)throw Error("Cannot use method in read-only mode.")}function _i(){if(Mt>99)throw Error("One or more transforms are endlessly triggering additional transforms. May have encountered infinite recursion caused by transforms that have their preconditions too lose and/or conflict with each other.")}function ne(){if(K===null)throw Error("Unable to find an active editor state. State helpers or node methods can only be used synchronously during the callback of editor.update() or editorState.read().");return K}function I(){if(B===null)throw Error("Unable to find an active editor. This method can only be used synchronously during the callback of editor.update().");return B}function zl(){return B}function vi(t,e,n){const r=e.__type,o=ca(t,r);let s=n.get(r);s===void 0&&(s=Array.from(o.transforms),n.set(r,s));const i=s.length;for(let a=0;a<i&&(s[a](e),!!e.isAttached());a++);}function yi(t,e){return t!==void 0&&t.__key!==e&&t.isAttached()}function Wl(t,e){const n=e._dirtyLeaves,r=t._nodeMap;for(const o of n){const s=r.get(o);E(s)&&s.isAttached()&&s.isSimpleText()&&!s.isUnmergeable()&&Rs(s)}}function Ul(t,e){const n=e._dirtyLeaves,r=e._dirtyElements,o=t._nodeMap,s=fe(),i=new Map;let a=n,l=a.size,c=r,f=c.size;for(;l>0||f>0;){if(l>0){e._dirtyLeaves=new Set;for(const h of a){const u=o.get(h);E(u)&&u.isAttached()&&u.isSimpleText()&&!u.isUnmergeable()&&Rs(u),u!==void 0&&yi(u,s)&&vi(e,u,i),n.add(h)}if(a=e._dirtyLeaves,l=a.size,l>0){Mt++;continue}}e._dirtyLeaves=new Set,e._dirtyElements=new Map;for(const h of c){const u=h[0],d=h[1];if(u!=="root"&&!d)continue;const g=o.get(u);g!==void 0&&yi(g,s)&&vi(e,g,i),r.set(u,d)}a=e._dirtyLeaves,l=a.size,c=e._dirtyElements,f=c.size,Mt++}e._dirtyLeaves=n,e._dirtyElements=r}function Gl(t){return Mo(t,I()._nodes)}function Mo(t,e){const n=t.type,r=e.get(n);if(r===void 0)throw Error(`parseEditorState: type "${n}" + not found`);const o=r.klass;if(t.type!==o.getType())throw Error(`LexicalNode: Node ${o.name} does not implement .importJSON().`);const s=o.importJSON(t),i=t.children;if(m(s)&&Array.isArray(i))for(let a=0;a<i.length;a++){const l=i[a],c=Mo(l,e);s.append(c)}return s}function Yl(t,e,n){const r=Ao(),o=K,s=J,i=B,a=e._dirtyElements,l=e._dirtyLeaves,c=e._cloneNotNeeded,f=e._dirtyType;e._dirtyElements=new Map,e._dirtyLeaves=new Set,e._cloneNotNeeded=new Set,e._dirtyType=0,K=r,J=!1,B=e;try{const h=e._nodes,u=t.root;Mo(u,h),n&&n(),r._readOnly=!0,mi(r)}finally{e._dirtyElements=a,e._dirtyLeaves=l,e._cloneNotNeeded=c,e._dirtyType=f,K=o,J=s,B=i}return r}function xi(t,e){const n=K,r=J,o=B;K=t,J=!0,B=null;try{return e()}finally{K=n,J=r,B=o}}function mi(t){const e=t._nodeMap;e.set=()=>{throw new Error("Cannot call set() on a frozen Lexical node map")},e.clear=()=>{throw new Error("Cannot call clear() on a frozen Lexical node map")},e.delete=()=>{throw new Error("Cannot call delete() on a frozen Lexical node map")}}function Te(t){const e=t._pendingEditorState,n=t._rootElement,r=t._headless||n===null;if(e===null)return;const o=t._editorState,s=o._selection,i=e._selection,a=t._dirtyType!==_e,l=K,c=J,f=B,h=t._updating,u=t._observer;let d=null;if(t._pendingEditorState=null,t._editorState=e,!r&&a&&u!==null){B=t,K=e,J=!1,t._updating=!0;try{const C=t._dirtyType,S=t._dirtyElements,b=t._dirtyLeaves;u.disconnect(),d=ul(o,e,t,C,S,b)}catch(C){if(C instanceof Error&&t._onError(C),!bo)Di(t,null,n,e),fs(t),t._dirtyType=Oe,bo=!0,Te(t),bo=!1;else throw C;return}finally{u.observe(n,pi),t._updating=h,K=l,J=c,B=f}}e._readOnly||(e._readOnly=!0,mi(e),M(i)&&(Object.freeze(i.anchor),Object.freeze(i.focus)),Object.freeze(i));const g=t._dirtyLeaves,$=t._dirtyElements,p=t._normalizedNodes,N=t._updateTags,_=t._deferred;a&&(t._dirtyType=_e,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements=new Map,t._normalizedNodes=new Set,t._updateTags=new Set),ol(t,e);const x=r?null:ee(t._window);if(t._editable&&x!==null&&(a||i===null||i.dirty)){B=t,K=e;try{if(u!==null&&u.disconnect(),a||i===null||i.dirty){const C=t._blockCursorElement;C!==null&&fo(C,t,n),Ll(s,i,t,x,N,n)}nl(t,n,i),u!==null&&u.observe(n,pi)}finally{B=f,K=l}}d!==null&&Vl(t,o,e,d,N,g),!M(i)&&i!==null&&(s===null||!s.is(i))&&t.dispatchCommand(Sr,void 0);const O=t._pendingDecorators;O!==null&&(t._decorators=O,t._pendingDecorators=null,rt("decorator",t,!0,O)),Hl(t,o,e),rt("update",t,!0,{dirtyElements:$,dirtyLeaves:g,editorState:e,normalizedNodes:p,prevEditorState:o,tags:N}),jl(t,_),Jl(t)}function Hl(t,e,n){const r=vs(e),o=vs(n);r!==o&&rt("textcontent",t,!0,o)}function Vl(t,e,n,r,o,s){const i=Array.from(t._listeners.mutation),a=i.length;for(let l=0;l<a;l++){const[c,f]=i[l],h=r.get(f);h!==void 0&&c(h,{dirtyLeaves:s,updateTags:o})}}function rt(t,e,n,...r){const o=e._updating;e._updating=n;try{const s=Array.from(e._listeners[t]);for(let i=0;i<s.length;i++)s[i].apply(null,r)}finally{e._updating=o}}function Ni(t,e,n){if(t._updating===!1||B!==t){let o=!1;return t.update(()=>{o=Ni(t,e,n)}),o}const r=ro(t);for(let o=4;o>=0;o--)for(let s=0;s<r.length;s++){const l=r[s]._commands.get(e);if(l!==void 0){const c=l[o];if(c!==void 0){const f=Array.from(c),h=f.length;for(let u=0;u<h;u++)if(f[u](n,t)===!0)return!0}}}return!1}function Jl(t){const e=t._updates;if(e.length!==0){const n=e.shift();if(n){const[r,o]=n;Ei(t,r,o)}}}function jl(t,e){if(t._deferred=[],e.length!==0){const n=t._updating;t._updating=!0;try{for(let r=0;r<e.length;r++)e[r]()}finally{t._updating=n}}}function Ti(t,e){const n=t._updates;let r=e||!1;for(;n.length!==0;){const o=n.shift();if(o){const[s,i]=o;let a,l;i!==void 0&&(a=i.onUpdate,l=i.tag,i.skipTransforms&&(r=!0),a&&t._deferred.push(a),l&&t._updateTags.add(l)),s()}}return r}function Ei(t,e,n){const r=t._updateTags;let o,s,i=!1,a=!1;n!==void 0&&(o=n.onUpdate,s=n.tag,s!=null&&r.add(s),i=n.skipTransforms||!1,a=n.discrete||!1),o&&t._deferred.push(o);const l=t._editorState;let c=t._pendingEditorState,f=!1;(c===null||c._readOnly)&&(c=t._pendingEditorState=Zl(c||l),f=!0),c._flushSync=a;const h=K,u=J,d=B,g=t._updating;K=c,J=!1,t._updating=!0,B=t;try{f&&(t._headless?l._selection!=null&&(c._selection=l._selection.clone()):c._selection=Il(t));const p=t._compositionKey;e(),i=Ti(t,i),Rl(c,t),t._dirtyType!==_e&&(i?Wl(c,t):Ul(c,t),Ti(t),sl(l,c,t._dirtyLeaves,t._dirtyElements));const N=t._compositionKey;p!==N&&(c._flushSync=!0);const _=c._selection;if(M(_)){const x=c._nodeMap,O=_.anchor.key,C=_.focus.key;if(x.get(O)===void 0||x.get(C)===void 0)throw Error("updateEditor: selection has been lost because the previously selected nodes have been removed and selection wasn't moved to another node. Ensure selection changes after removing/replacing a selected node.")}else tt(_)&&_._nodes.size===0&&(c._selection=null)}catch(p){p instanceof Error&&t._onError(p),t._pendingEditorState=l,t._dirtyType=Oe,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),Te(t);return}finally{K=h,J=u,B=d,t._updating=g,Mt=0}t._dirtyType!==_e||Ql(c,t)?c._flushSync?(c._flushSync=!1,Te(t)):f&&fa(()=>{Te(t)}):(c._flushSync=!1,f&&(r.clear(),t._deferred=[],t._pendingEditorState=null))}function X(t,e,n){t._updating?t._updates.push([e,n]):Ei(t,e,n)}function Do(t,e,n){G();const r=t.__key,o=t.getParent();if(o===null)return;const s=Qa(t);let i=!1;if(M(s)&&e){const a=s.anchor,l=s.focus;a.key===r&&(bt(a,t,o,t.getPreviousSibling(),t.getNextSibling()),i=!0),l.key===r&&(bt(l,t,o,t.getPreviousSibling(),t.getNextSibling()),i=!0)}if(M(s)&&e&&!i){const a=t.getIndexWithinParent();ye(t),Ot(s,o,a,-1)}else ye(t);!n&&!Z(o)&&!o.canBeEmpty()&&o.isEmpty()&&Do(o,e),e&&j(o)&&o.isEmpty()&&o.selectEnd()}class Dt{static getType(){throw Error(`LexicalNode: Node ${this.name} does not implement .getType().`)}static clone(e){throw Error(`LexicalNode: Node ${this.name} does not implement .clone().`)}getType(){return this.__type}isAttached(){let e=this.__key;for(;e!==null;){if(e==="root")return!0;const n=F(e);if(n===null)break;e=n.__parent}return!1}isSelected(e){const n=e||P();if(n==null)return!1;const r=n.getNodes().some(o=>o.__key===this.__key);return E(this)?r:M(n)&&n.anchor.type==="element"&&n.focus.type==="element"&&n.anchor.key===n.focus.key&&n.anchor.offset===n.focus.offset?!1:r}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(e===null)return-1;let n=e.getFirstChild(),r=0;for(;n!==null;){if(this.is(n))return r;r++,n=n.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;return e===null?null:F(e)}getParentOrThrow(){const e=this.getParent();if(e===null)throw Error(`Expected node ${this.__key} to have a parent.`);return e}getTopLevelElement(){let e=this;for(;e!==null;){const n=e.getParent();if(Z(n))return e;e=n}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();if(e===null)throw Error(`Expected node ${this.__key} to have a top parent element.`);return e}getParents(){const e=[];let n=this.getParent();for(;n!==null;)e.push(n),n=n.getParent();return e}getParentKeys(){const e=[];let n=this.getParent();for(;n!==null;)e.push(n.__key),n=n.getParent();return e}getPreviousSibling(){const n=this.getLatest().__prev;return n===null?null:F(n)}getPreviousSiblings(){const e=[],n=this.getParent();if(n===null)return e;let r=n.getFirstChild();for(;r!==null&&!r.is(this);)e.push(r),r=r.getNextSibling();return e}getNextSibling(){const n=this.getLatest().__next;return n===null?null:F(n)}getNextSiblings(){const e=[];let n=this.getNextSibling();for(;n!==null;)e.push(n),n=n.getNextSibling();return e}getCommonAncestor(e){const n=this.getParents(),r=e.getParents();m(this)&&n.unshift(this),m(e)&&r.unshift(e);const o=n.length,s=r.length;if(o===0||s===0||n[o-1]!==r[s-1])return null;const i=new Set(r);for(let a=0;a<o;a++){const l=n[a];if(i.has(l))return l}return null}is(e){return e==null?!1:this.__key===e.__key}isBefore(e){if(this===e)return!1;if(e.isParentOf(this))return!0;if(this.isParentOf(e))return!1;const n=this.getCommonAncestor(e);let r=0,o=0,s=this;for(;;){const i=s.getParentOrThrow();if(i===n){r=s.getIndexWithinParent();break}s=i}for(s=e;;){const i=s.getParentOrThrow();if(i===n){o=s.getIndexWithinParent();break}s=i}return r<o}isParentOf(e){const n=this.__key;if(n===e.__key)return!1;let r=e;for(;r!==null;){if(r.__key===n)return!0;r=r.getParent()}return!1}getNodesBetween(e){const n=this.isBefore(e),r=[],o=new Set;let s=this;for(;;){const i=s.__key;if(o.has(i)||(o.add(i),r.push(s)),s===e)break;const a=m(s)?n?s.getFirstChild():s.getLastChild():null;if(a!==null){s=a;continue}const l=n?s.getNextSibling():s.getPreviousSibling();if(l!==null){s=l;continue}const c=s.getParentOrThrow();if(o.has(c.__key)||r.push(c),c===e)break;let f=null,h=c;do{if(h===null)throw Error("getNodesBetween: ancestor is null");f=n?h.getNextSibling():h.getPreviousSibling(),h=h.getParent(),h!==null&&f===null&&!o.has(h.__key)&&r.push(h)}while(f===null);s=f}return n||r.reverse(),r}isDirty(){const n=I()._dirtyLeaves;return n!==null&&n.has(this.__key)}getLatest(){const e=F(this.__key);if(e===null)throw Error("Lexical node does not exist in active editor state. Avoid using the same node references between nested closures from editorState.read/editor.update.");return e}getWritable(){G();const e=ne(),n=I(),r=e._nodeMap,o=this.__key,s=this.getLatest(),i=s.__parent,a=n._cloneNotNeeded,l=P();if(l!==null&&(l._cachedNodes=null),a.has(o))return dt(s),s;const f=s.constructor.clone(s);return f.__parent=i,f.__next=s.__next,f.__prev=s.__prev,m(s)&&m(f)?(f.__first=s.__first,f.__last=s.__last,f.__size=s.__size,f.__indent=s.__indent,f.__format=s.__format,f.__dir=s.__dir):E(s)&&E(f)&&(f.__format=s.__format,f.__style=s.__style,f.__mode=s.__mode,f.__detail=s.__detail),a.add(o),f.__key=o,dt(f),r.set(o,f),f}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,n){throw Error("createDOM: base method not extended")}updateDOM(e,n,r){throw Error("updateDOM: base method not extended")}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){throw Error("exportJSON: base method not extended")}static importJSON(e){throw Error(`LexicalNode: Node ${this.name} does not implement .importJSON().`)}static transform(){return null}remove(e){Do(this,!0,e)}replace(e,n){G();let r=P();r!==null&&(r=r.clone()),lo(this,e);const o=this.getLatest(),s=this.__key,i=e.__key,a=e.getWritable(),l=this.getParentOrThrow().getWritable(),c=l.__size;ye(a);const f=o.getPreviousSibling(),h=o.getNextSibling(),u=o.__prev,d=o.__next,g=o.__parent;if(Do(o,!1,!0),f===null)l.__first=i;else{const $=f.getWritable();$.__next=i}if(a.__prev=u,h===null)l.__last=i;else{const $=h.getWritable();$.__prev=i}if(a.__next=d,a.__parent=g,l.__size=c,n&&this.getChildren().forEach($=>{a.append($)}),M(r)){de(r);const $=r.anchor,p=r.focus;$.key===s&&ri($,a),p.key===s&&ri(p,a)}return fe()===s&&z(i),a}insertAfter(e,n=!0){G(),lo(this,e);const r=this.getWritable(),o=e.getWritable(),s=o.getParent(),i=P();let a=!1,l=!1;if(s!==null){const d=e.getIndexWithinParent();if(ye(o),M(i)){const g=s.__key,$=i.anchor,p=i.focus;a=$.type==="element"&&$.key===g&&$.offset===d+1,l=p.type==="element"&&p.key===g&&p.offset===d+1}}const c=this.getNextSibling(),f=this.getParentOrThrow().getWritable(),h=o.__key,u=r.__next;if(c===null)f.__last=h;else{const d=c.getWritable();d.__prev=h}if(f.__size++,r.__next=h,o.__next=u,o.__prev=r.__key,o.__parent=r.__parent,n&&M(i)){const d=this.getIndexWithinParent();Ot(i,f,d+1);const g=f.__key;a&&i.anchor.set(g,d+2,"element"),l&&i.focus.set(g,d+2,"element")}return e}insertBefore(e,n=!0){G(),lo(this,e);const r=this.getWritable(),o=e.getWritable(),s=o.__key;ye(o);const i=this.getPreviousSibling(),a=this.getParentOrThrow().getWritable(),l=r.__prev,c=this.getIndexWithinParent();if(i===null)a.__first=s;else{const h=i.getWritable();h.__next=s}a.__size++,r.__prev=s,o.__prev=l,o.__next=r.__key,o.__parent=r.__parent;const f=P();if(n&&M(f)){const h=this.getParentOrThrow();Ot(f,h,c)}return e}isParentRequired(){return!1}createParentElementNode(){return Ce()}selectPrevious(e,n){G();const r=this.getPreviousSibling(),o=this.getParentOrThrow();if(r===null)return o.select(0,0);if(m(r))return r.select();if(!E(r)){const s=r.getIndexWithinParent()+1;return o.select(s,s)}return r.select(e,n)}selectNext(e,n){G();const r=this.getNextSibling(),o=this.getParentOrThrow();if(r===null)return o.select();if(m(r))return r.select(0,0);if(!E(r)){const s=r.getIndexWithinParent();return o.select(s,s)}return r.select(e,n)}markDirty(){this.getWritable()}constructor(e){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,gs(this,e),this.__type!=="root"&&(G(),Xl(this.__type,this.constructor))}}function Xl(t,e){const n=I()._nodes.get(t);if(n===void 0)throw Error(`Create node: Attempted to create node ${e.name} that was not configured to be used on the editor.`);const r=n.klass;if(r!==e)throw Error(`Create node: Type ${t} in node ${e.name} does not match registered node ${r.name} with the same type`)}class wo extends Dt{decorate(e,n){throw Error("decorate: base method not extended")}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}constructor(e){super(e)}}function k(t){return t instanceof wo}class Ee extends Dt{getFormat(){return this.getLatest().__format}getFormatType(){const e=this.getFormat();return qi[e]||""}getIndent(){return this.getLatest().__indent}getChildren(){const e=[];let n=this.getFirstChild();for(;n!==null;)e.push(n),n=n.getNextSibling();return e}getChildrenKeys(){const e=[];let n=this.getFirstChild();for(;n!==null;)e.push(n.__key),n=n.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const n=I()._dirtyElements;return n!==null&&n.has(this.__key)}isLastChild(){const e=this.getLatest(),n=this.getParentOrThrow().getLastChild();return n!==null&&n.is(e)}getAllTextNodes(){const e=[];let n=this.getFirstChild();for(;n!==null;){if(E(n)&&e.push(n),m(n)){const r=n.getAllTextNodes();e.push(...r)}n=n.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;e!==null;){if(m(e)){const n=e.getFirstChild();if(n!==null){e=n;continue}}break}return e}getLastDescendant(){let e=this.getLastChild();for(;e!==null;){if(m(e)){const n=e.getLastChild();if(n!==null){e=n;continue}}break}return e}getDescendantByIndex(e){const n=this.getChildren(),r=n.length;if(e>=r){const s=n[r-1];return m(s)&&s.getLastDescendant()||s||null}const o=n[e];return m(o)&&o.getFirstDescendant()||o||null}getFirstChild(){const n=this.getLatest().__first;return n===null?null:F(n)}getFirstChildOrThrow(){const e=this.getFirstChild();if(e===null)throw Error(`Expected node ${this.__key} to have a first child.`);return e}getLastChild(){const n=this.getLatest().__last;return n===null?null:F(n)}getLastChildOrThrow(){const e=this.getLastChild();if(e===null)throw Error(`Expected node ${this.__key} to have a last child.`);return e}getChildAtIndex(e){const n=this.getChildrenSize();let r,o;if(e<n/2){for(r=this.getFirstChild(),o=0;r!==null&&o<=e;){if(o===e)return r;r=r.getNextSibling(),o++}return null}for(r=this.getLastChild(),o=n-1;r!==null&&o>=e;){if(o===e)return r;r=r.getPreviousSibling(),o--}return null}getTextContent(){let e="";const n=this.getChildren(),r=n.length;for(let o=0;o<r;o++){const s=n[o];e+=s.getTextContent(),m(s)&&o!==r-1&&!s.isInline()&&(e+=se)}return e}getTextContentSize(){let e=0;const n=this.getChildren(),r=n.length;for(let o=0;o<r;o++){const s=n[o];e+=s.getTextContentSize(),m(s)&&o!==r-1&&!s.isInline()&&(e+=se.length)}return e}getDirection(){return this.getLatest().__dir}hasFormat(e){if(e!==""){const n=as[e];return(this.getFormat()&n)!=0}return!1}select(e,n){G();const r=P();let o=e,s=n;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(e===0&&n===0){const l=this.getFirstChild();if(E(l)||m(l))return l.select(0,0)}else if((e===void 0||e===i)&&(n===void 0||n===i)){const l=this.getLastChild();if(E(l)||m(l))return l.select()}}o===void 0&&(o=i),s===void 0&&(s=i);const a=this.__key;if(M(r))r.anchor.set(a,o,"element"),r.focus.set(a,s,"element"),r.dirty=!0;else return ui(a,o,a,s,"element","element");return r}selectStart(){const e=this.getFirstDescendant();return m(e)||E(e)?e.select(0,0):e!==null?e.selectPrevious():this.select(0,0)}selectEnd(){const e=this.getLastDescendant();return m(e)||E(e)?e.select():e!==null?e.selectNext():this.select()}clear(){const e=this.getWritable();return this.getChildren().forEach(r=>r.remove()),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const n=this.getWritable();return n.__dir=e,n}setFormat(e){const n=this.getWritable();return n.__format=e!==""?as[e]:0,this}setIndent(e){const n=this.getWritable();return n.__indent=e,this}splice(e,n,r){const o=r.length,s=this.getChildrenSize(),i=this.getWritable(),a=i.__key,l=[],c=[],f=this.getChildAtIndex(e+n);let h=null,u=s-n+o;if(e!==0)if(e===s)h=this.getLastChild();else{const g=this.getChildAtIndex(e);g!==null&&(h=g.getPreviousSibling())}if(n>0){let g=h===null?this.getFirstChild():h.getNextSibling();for(let $=0;$<n;$++){if(g===null)throw Error("splice: sibling not found");const p=g.getNextSibling(),N=g.__key,_=g.getWritable();ye(_),c.push(N),g=p}}let d=h;for(let g=0;g<o;g++){const $=r[g];d!==null&&$.is(d)&&(h=d=d.getPreviousSibling());const p=$.getWritable();p.__parent===a&&u--,ye(p);const N=$.__key;if(d===null)i.__first=N,p.__prev=null;else{const _=d.getWritable();_.__next=N,p.__prev=_.__key}if($.__key===a)throw Error("append: attempting to append self");p.__parent=a,l.push(N),d=$}if(e+n===s){if(d!==null){const g=d.getWritable();g.__next=null,i.__last=d.__key}}else if(f!==null){const g=f.getWritable();if(d!==null){const $=d.getWritable();g.__prev=d.__key,$.__next=f.__key}else g.__prev=null}if(i.__size=u,c.length){const g=P();if(M(g)){const $=new Set(c),p=new Set(l),{anchor:N,focus:_}=g;Ci(N,$,p)&&bt(N,N.getNode(),this,h,f),Ci(_,$,p)&&bt(_,_.getNode(),this,h,f),u===0&&!this.canBeEmpty()&&!Z(this)&&this.remove()}}return i}exportJSON(){return{children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),type:"element",version:1}}insertNewAfter(e,n){return null}canInsertTab(){return!1}canIndent(){return!0}collapseAtStart(e){return!1}excludeFromCopy(e){return!1}canExtractContents(){return!0}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(e){return!1}extractWithChild(e,n,r){return!1}constructor(e){super(e);this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__indent=0,this.__dir=null}}function m(t){return t instanceof Ee}function Ci(t,e,n){let r=t.getNode();for(;r;){const o=r.__key;if(e.has(o)&&!n.has(o))return!0;r=r.getParent()}return!1}class Ae extends Ee{static getType(){return"root"}static clone(){return new Ae}getTopLevelElementOrThrow(){throw Error("getTopLevelElementOrThrow: root nodes are not top level elements")}getTextContent(){const e=this.__cachedText;return(we()||I()._dirtyType===_e)&&e!==null?e:super.getTextContent()}remove(){throw Error("remove: cannot be called on root nodes")}replace(e){throw Error("replace: cannot be called on root nodes")}insertBefore(e){throw Error("insertBefore: cannot be called on root nodes")}insertAfter(e){throw Error("insertAfter: cannot be called on root nodes")}updateDOM(e,n){return!1}append(...e){for(let n=0;n<e.length;n++){const r=e[n];if(!m(r)&&!k(r))throw Error("rootNode.append: Only element or decorator nodes can be appended to the root node")}return super.append(...e)}static importJSON(e){const n=ie();return n.setFormat(e.format),n.setIndent(e.indent),n.setDirection(e.direction),n}exportJSON(){return{children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),type:"root",version:1}}collapseAtStart(){return!0}constructor(){super("root");this.__cachedText=null}}function ql(){return new Ae}function j(t){return t instanceof Ae}function Ql(t,e){const n=e.getEditorState()._selection,r=t._selection;if(r!==null){if(r.dirty||!r.is(n))return!0}else if(n!==null)return!0;return!1}function Zl(t){return new wt(new Map(t._nodeMap))}function Ao(){return new wt(new Map([["root",ql()]]))}function Si(t){const e=t.exportJSON(),n=t.constructor;if(e.type!==n.getType())throw Error(`LexicalNode: Node ${n.name} does not implement .exportJSON().`);const r=e.children;if(m(t)){if(!Array.isArray(r))throw Error(`LexicalNode: Node ${n.name} is an element but .exportJSON() does not have a children array.`);const o=t.getChildren();for(let s=0;s<o.length;s++){const i=o[s],a=Si(i);r.push(a)}}return e}class wt{isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(e){return xi(this,e)}clone(e){const n=new wt(this._nodeMap,e===void 0?this._selection:e);return n._readOnly=!0,n}toJSON(){return xi(this,()=>({root:Si(ie())}))}constructor(e,n){this._nodeMap=e,this._selection=n||null,this._flushSync=!1,this._readOnly=!1}}class Pe extends Dt{static getType(){return"linebreak"}static clone(e){return new Pe(e.__key)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}static importDOM(){return{br:e=>{const n=e.parentElement;return n!=null&&n.firstChild===e&&n.lastChild===e?null:{conversion:ec,priority:0}}}}static importJSON(e){return ke()}exportJSON(){return{type:"linebreak",version:1}}constructor(e){super(e)}}function ec(t){return{node:ke()}}function ke(){return vt(new Pe)}function ot(t){return t instanceof Pe}function Po(t,e){return e&zr?"code":e&Gr?"mark":e&Wr?"sub":e&Ur?"sup":null}function ko(t,e){return e&Kr?"strong":e&Br?"em":"span"}function Oi(t,e,n,r,o){const s=r.classList;let i=Ve(o,"base");i!==void 0&&s.add(...i),i=Ve(o,"underlineStrikethrough");let a=!1;const l=e&lt&&e&at,c=n&lt&&n&at;i!==void 0&&(c?(a=!0,l||s.add(...i)):l&&s.remove(...i));for(const f in ve){const u=ve[f];if(i=Ve(o,f),i!==void 0)if(n&u){if(a&&(f==="underline"||f==="strikethrough")){e&u&&s.remove(...i);continue}((e&u)==0||l&&f==="underline"||f==="strikethrough")&&s.add(...i)}else e&u&&s.remove(...i)}}function tc(t,e){const n=t.length,r=e.length;let o=0,s=0;for(;o<n&&o<r&&t[o]===e[o];)o++;for(;s+o<n&&s+o<r&&t[n-s-1]===e[r-s-1];)s++;return[o,n-o-s,e.slice(o,r-s)]}function bi(t,e,n){const r=e.firstChild,o=n.isComposing(),i=t+(o?ct:"");if(r==null)e.textContent=i;else{const a=r.nodeValue;if(a!==i)if(o||pe){const[l,c,f]=tc(a,i);c!==0&&r.deleteData(l,c),r.insertData(l,f)}else r.nodeValue=i}}function Mi(t,e,n,r,o,s){bi(o,t,e);const a=s.theme.text;a!==void 0&&Oi(n,0,r,t,a)}function At(t,e){const n=document.createElement(e);return n.appendChild(t),n}class Ie extends Dt{static getType(){return"text"}static clone(e){return new Ie(e.__text,e.__key)}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const e=this.getLatest();return Zi[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===Lr}isComposing(){return this.__key===fe()}isSegmented(){return this.getLatest().__mode===Fr}isDirectionless(){return(this.getLatest().__detail&Yr)!=0}isUnmergeable(){return(this.getLatest().__detail&Hr)!=0}hasFormat(e){const n=ve[e];return(this.getFormat()&n)!=0}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(e,n){const o=this.getLatest().__format;return hs(o,e,n)}createDOM(e){const n=this.__format,r=Po(this,n),o=ko(this,n),s=r===null?o:r,i=document.createElement(s);let a=i;r!==null&&(a=document.createElement(o),i.appendChild(a));const l=this.__text;Mi(a,this,o,n,l,e);const c=this.__style;return c!==""&&(i.style.cssText=c),i}updateDOM(e,n,r){const o=this.__text,s=e.__format,i=this.__format,a=Po(this,s),l=Po(this,i),c=ko(this,s),f=ko(this,i);if((a===null?c:a)!==(l===null?f:l))return!0;if(a===l&&c!==f){const _=n.firstChild;if(_==null)throw Error("updateDOM: prevInnerDOM is null or undefined");const x=document.createElement(f);return Mi(x,this,f,i,o,r),n.replaceChild(x,_),!1}let d=n;if(l!==null&&a!==null&&(d=n.firstChild,d==null))throw Error("updateDOM: innerDOM is null or undefined");bi(o,d,this);const $=r.theme.text;$!==void 0&&s!==i&&Oi(f,s,i,d,$);const p=e.__style,N=this.__style;return p!==N&&(n.style.cssText=N),!1}static importDOM(){return{"#text":()=>({conversion:sc,priority:0}),b:()=>({conversion:oc,priority:0}),br:()=>({conversion:rc,priority:0}),code:()=>({conversion:ge,priority:0}),em:()=>({conversion:ge,priority:0}),i:()=>({conversion:ge,priority:0}),s:()=>({conversion:ge,priority:0}),span:()=>({conversion:nc,priority:0}),strong:()=>({conversion:ge,priority:0}),sub:()=>({conversion:ge,priority:0}),sup:()=>({conversion:ge,priority:0}),u:()=>({conversion:ge,priority:0})}}static importJSON(e){const n=W(e.text);return n.setFormat(e.format),n.setDetail(e.detail),n.setMode(e.mode),n.setStyle(e.style),n}exportDOM(e){let{element:n}=super.exportDOM(e);return n!==null&&(this.hasFormat("bold")&&(n=At(n,"b")),this.hasFormat("italic")&&(n=At(n,"i")),this.hasFormat("strikethrough")&&(n=At(n,"s")),this.hasFormat("underline")&&(n=At(n,"u"))),{element:n}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),type:"text",version:1}}selectionTransform(e,n){}setFormat(e){const n=this.getWritable();return n.__format=typeof e=="string"?ve[e]:e,n}setDetail(e){const n=this.getWritable();return n.__detail=typeof e=="string"?Xi[e]:e,n}setStyle(e){const n=this.getWritable();return n.__style=e,n}toggleFormat(e){const n=ve[e];return this.setFormat(this.getFormat()^n)}toggleDirectionless(){const e=this.getWritable();return e.__detail^=Yr,e}toggleUnmergeable(){const e=this.getWritable();return e.__detail^=Hr,e}setMode(e){const n=Qi[e];if(this.__mode===n)return this;const r=this.getWritable();return r.__mode=n,r}setTextContent(e){if(this.__text===e)return this;const n=this.getWritable();return n.__text=e,n}select(e,n){G();let r=e,o=n;const s=P(),i=this.getTextContent(),a=this.__key;if(typeof i=="string"){const l=i.length;r===void 0&&(r=l),o===void 0&&(o=l)}else r=0,o=0;if(M(s)){const l=fe();(l===s.anchor.key||l===s.focus.key)&&z(a),s.setTextNodeRange(this,r,this,o)}else return ui(a,r,a,o,"text","text");return s}spliceText(e,n,r,o){const s=this.getWritable(),i=s.__text,a=r.length;let l=e;l<0&&(l=a+l,l<0&&(l=0));const c=P();if(o&&M(c)){const h=e+a;c.setTextNodeRange(s,h,s,h)}const f=i.slice(0,l)+r+i.slice(l+n);return s.__text=f,s}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}canContainTabs(){return!1}splitText(...e){G();const n=this.getLatest(),r=n.getTextContent(),o=n.__key,s=fe(),i=new Set(e),a=[],l=r.length;let c="";for(let b=0;b<l;b++)c!==""&&i.has(b)&&(a.push(c),c=""),c+=r[b];c!==""&&a.push(c);const f=a.length;if(f===0)return[];if(a[0]===r)return[n];const h=a[0],u=n.getParentOrThrow();let d;const g=n.getFormat(),$=n.getStyle(),p=n.__detail;let N=!1;n.isSegmented()?(d=W(h),d.__format=g,d.__style=$,d.__detail=p,N=!0):(d=n.getWritable(),d.__text=h);const _=P(),x=[d];let O=h.length;for(let b=1;b<f;b++){const w=a[b],U=w.length,V=W(w).getWritable();V.__format=g,V.__style=$,V.__detail=p;const A=V.__key,L=O+U;if(M(_)){const q=_.anchor,re=_.focus;q.key===o&&q.type==="text"&&q.offset>O&&q.offset<=L&&(q.key=A,q.offset-=O,_.dirty=!0),re.key===o&&re.type==="text"&&re.offset>O&&re.offset<=L&&(re.key=A,re.offset-=O,_.dirty=!0)}s===o&&z(A),O=L,x.push(V)}ga(this);const C=u.getWritable(),S=this.getIndexWithinParent();return N?(C.splice(S,0,x),this.remove()):C.splice(S,1,x),M(_)&&Ot(_,u,S,f-1),x}mergeWithSibling(e){const n=e===this.getPreviousSibling();if(!n&&e!==this.getNextSibling())throw Error("mergeWithSibling: sibling must be a previous or next sibling");const r=this.__key,o=e.__key,s=this.__text,i=s.length;fe()===o&&z(r);const l=P();if(M(l)){const u=l.anchor,d=l.focus;u!==null&&u.key===o&&(gi(u,n,r,e,i),l.dirty=!0),d!==null&&d.key===o&&(gi(d,n,r,e,i),l.dirty=!0)}const c=e.__text,f=n?c+s:s+c;this.setTextContent(f);const h=this.getWritable();return e.remove(),h}isTextEntity(){return!1}constructor(e,n){super(n);this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}}function nc(t){const e=t,n=e.style.fontWeight==="700",r=e.style.textDecoration==="line-through",o=e.style.fontStyle==="italic",s=e.style.textDecoration==="underline",i=e.style.verticalAlign;return{forChild:a=>(E(a)&&(n&&a.toggleFormat("bold"),r&&a.toggleFormat("strikethrough"),o&&a.toggleFormat("italic"),s&&a.toggleFormat("underline"),i==="sub"&&a.toggleFormat("subscript"),i==="super"&&a.toggleFormat("superscript")),a),node:null}}function rc(){return{node:ke()}}function oc(t){const n=t.style.fontWeight==="normal";return{forChild:r=>(E(r)&&!n&&r.toggleFormat("bold"),r),node:null}}function sc(t,e,n){let r=t.textContent||"";return!n&&/\n/.test(r)&&(r=r.replace(/\r?\n/gm," "),r.trim().length===0)?{node:null}:{node:W(r)}}const ic={code:"code",em:"italic",i:"italic",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function ge(t){const e=ic[t.nodeName.toLowerCase()];return e===void 0?{node:null}:{forChild:n=>(E(n)&&!n.hasFormat(e)&&n.toggleFormat(e),n),node:null}}function W(t=""){return vt(new Ie(t))}function E(t){return t instanceof Ie}class Re extends Ee{static getType(){return"paragraph"}static clone(e){return new Re(e.__key)}createDOM(e){const n=document.createElement("p"),r=Ve(e.theme,"paragraph");return r!==void 0&&n.classList.add(...r),n}updateDOM(e,n,r){return!1}static importDOM(){return{p:e=>({conversion:ac,priority:0})}}exportDOM(e){const{element:n}=super.exportDOM(e);if(n&&this.isEmpty()&&n.append(document.createElement("br")),n){const r=this.getFormatType();n.style.textAlign=r;const o=this.getDirection();o&&(n.dir=o);const s=this.getIndent();s>0&&(n.style.textIndent=`${s*20}px`)}return{element:n}}static importJSON(e){const n=Ce();return n.setFormat(e.format),n.setIndent(e.indent),n.setDirection(e.direction),n}exportJSON(){return{...super.exportJSON(),type:"paragraph",version:1}}insertNewAfter(e,n){const r=Ce(),o=this.getDirection();return r.setDirection(o),this.insertAfter(r,n),r}collapseAtStart(){const e=this.getChildren();if(e.length===0||E(e[0])&&e[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function ac(t){const e=Ce();if(t.style){e.setFormat(t.style.textAlign);const n=parseInt(t.style.textIndent,10)/20;n>0&&e.setIndent(n)}return{node:e}}function Ce(){return vt(new Re)}function lc(t){return t instanceof Re}const cc=0,fc=1,dc=2,uc=3,hc=4;function Di(t,e,n,r){const o=t._keyToDOMMap;o.clear(),t._editorState=Ao(),t._pendingEditorState=r,t._compositionKey=null,t._dirtyType=_e,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),t._normalizedNodes=new Set,t._updateTags=new Set,t._updates=[],t._blockCursorElement=null;const s=t._observer;s!==null&&(s.disconnect(),t._observer=null),e!==null&&(e.textContent=""),n!==null&&(n.textContent="",o.set("root",n))}function $c(t){const e=new Map,n=new Set;return t.forEach(r=>{const o=r.klass.importDOM!=null?r.klass.importDOM.bind(r.klass):null;if(o==null||n.has(o))return;n.add(o);const s=o();s!==null&&Object.keys(s).forEach(i=>{let a=e.get(i);a===void 0&&(a=[],e.set(i,a)),a.push(s[i])})}),e}function gc(t){const e=t||{},n=zl(),r=e.theme||{},o=t===void 0?n:e.parentEditor||null,s=e.disableEvents||!1,i=Ao(),a=e.namespace||(o!==null?o._config.namespace:Ns()),l=e.editorState,c=[Ae,Ie,Pe,Re,...e.nodes||[]],f=e.onError,h=e.editable!==void 0?e.editable:!0;let u;if(t===void 0&&n!==null)u=n._nodes;else{u=new Map;for(let g=0;g<c.length;g++){let $=c[g],p=null,N=null;if(typeof $!="function"){const C=$;$=C.replace,p=C.with,N=C.withKlass?C.withKlass:null}{const C=$.name;if(C!=="RootNode"){const S=$.prototype;["getType","clone"].forEach(b=>{$.hasOwnProperty(b)||console.warn(`${C} must implement static "${b}" method`)}),!$.hasOwnProperty("importDOM")&&$.hasOwnProperty("exportDOM")&&console.warn(`${C} should implement "importDOM" if using a custom "exportDOM" method to ensure HTML serialization (important for copy & paste) works as expected`),S instanceof wo&&(S.hasOwnProperty("decorate")||console.warn(`${S.constructor.name} must implement "decorate" method`)),$.hasOwnProperty("importJSON")||console.warn(`${C} should implement "importJSON" method to ensure JSON and default HTML serialization works as expected`),S.hasOwnProperty("exportJSON")||console.warn(`${C} should implement "exportJSON" method to ensure JSON and default HTML serialization works as expected`)}}const _=$.getType(),x=$.transform(),O=new Set;x!==null&&O.add(x),u.set(_,{klass:$,replace:p,replaceWithKlass:N,transforms:O})}}const d=new pc(i,o,u,{disableEvents:s,namespace:a,theme:r},f||console.error,$c(u),h);return l!==void 0&&(d._pendingEditorState=l,d._dirtyType=Oe),d}class pc{isComposing(){return this._compositionKey!=null}registerUpdateListener(e){const n=this._listeners.update;return n.add(e),()=>{n.delete(e)}}registerEditableListener(e){const n=this._listeners.editable;return n.add(e),()=>{n.delete(e)}}registerDecoratorListener(e){const n=this._listeners.decorator;return n.add(e),()=>{n.delete(e)}}registerTextContentListener(e){const n=this._listeners.textcontent;return n.add(e),()=>{n.delete(e)}}registerRootListener(e){const n=this._listeners.root;return e(this._rootElement,null),n.add(e),()=>{e(null,this._rootElement),n.delete(e)}}registerCommand(e,n,r){if(r===void 0)throw Error('Listener for type "command" requires a "priority".');const o=this._commands;o.has(e)||o.set(e,[new Set,new Set,new Set,new Set,new Set]);const s=o.get(e);if(s===void 0)throw Error(`registerCommand: Command ${String(e)} not found in command map`);const i=s[r];return i.add(n),()=>{i.delete(n),s.every(a=>a.size===0)&&o.delete(e)}}registerMutationListener(e,n){if(this._nodes.get(e.getType())===void 0)throw Error(`Node ${e.name} has not been registered. Ensure node has been passed to createEditor.`);const o=this._listeners.mutation;return o.set(n,e),()=>{o.delete(n)}}registerNodeTransformToKlass(e,n){const r=e.getType(),o=this._nodes.get(r);if(o===void 0)throw Error(`Node ${e.name} has not been registered. Ensure node has been passed to createEditor.`);return o.transforms.add(n),o}registerNodeTransform(e,n){const r=this.registerNodeTransformToKlass(e,n),o=[r],s=r.replaceWithKlass;if(s!=null){const i=this.registerNodeTransformToKlass(s,n);o.push(i)}return pa(this,e.getType()),()=>{o.forEach(i=>i.transforms.delete(n))}}hasNodes(e){for(let n=0;n<e.length;n++){const o=e[n].getType();if(!this._nodes.has(o))return!1}return!0}dispatchCommand(e,n){return T(this,e,n)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const n=this._rootElement;if(e!==n){const r=Ve(this._config.theme,"root"),o=this._pendingEditorState||this._editorState;if(this._rootElement=e,Di(this,n,e,o),n!==null&&(this._config.disableEvents||El(n),r!=null&&n.classList.remove(...r)),e!==null){const s=Za(e),i=e.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=s,this._dirtyType=Oe,fs(this),this._updateTags.add("history-merge"),Te(this),this._config.disableEvents||Tl(e,this),r!=null&&e.classList.add(...r)}else this._window=null;rt("root",this,!1,e,n)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,n){if(e.isEmpty())throw Error("setEditorState: the editor state is empty. Ensure the editor state's root node never becomes empty.");cs(this);const r=this._pendingEditorState,o=this._updateTags,s=n!==void 0?n.tag:null;r!==null&&!r.isEmpty()&&(s!=null&&o.add(s),Te(this)),this._pendingEditorState=e,this._dirtyType=Oe,this._dirtyElements.set("root",!1),this._compositionKey=null,s!=null&&o.add(s),Te(this)}parseEditorState(e,n){const r=typeof e=="string"?JSON.parse(e):e;return Yl(r,this,n)}update(e,n){X(this,e,n)}focus(e,n={}){const r=this._rootElement;r!==null&&(r.setAttribute("autocapitalize","off"),X(this,()=>{const o=P(),s=ie();o!==null?o.dirty=!0:s.getChildrenSize()!==0&&(n.defaultSelection==="rootStart"?s.selectStart():s.selectEnd())},{onUpdate:()=>{r.removeAttribute("autocapitalize"),e&&e()}}),this._pendingEditorState===null&&r.removeAttribute("autocapitalize"))}blur(){const e=this._rootElement;e!==null&&e.blur();const n=ee(this._window);n!==null&&n.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,rt("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}constructor(e,n,r,o,s,i,a){this._parentEditor=n,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=o,this._nodes=r,this._decorators={},this._pendingDecorators=null,this._dirtyType=_e,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=Ns(),this._onError=s,this._htmlConversions=i,this._editable=!0,this._headless=n!==null&&n._headless,this._window=null,this._blockCursorElement=null}}class wi extends Ee{exportJSON(){return{...super.exportJSON(),colSpan:this.__colSpan}}setColSpan(e){return this.getWritable().__colSpan=e,this}setRowSpan(e){return this.getWritable().__rowSpan=e,this}constructor(e,n){super(n);this.__colSpan=e,this.__rowSpan=1}}function Le(t){return t instanceof wi}class Ai extends Ee{}function Pi(t){return t instanceof Ai}class ki extends Ee{}function Pt(t){return t instanceof ki}kt=qa;It=vt;Rt=Ds;Lt=ke;Ft=Oo;Kt=Ce;Bt=Pl;zt=W;Wt=ao;Ut=Ge;Gt=Ms;Yt=F;Ht=nt;Vt=ie;Jt=P;jt=Kl;Xt=pt;qt=Fl;Qt=k;Zt=m;en=el;tn=$s;nn=ot;rn=tt;on=lc;sn=M;an=j;ln=Z;cn=E;fn=ja;dn=Ls;un=Gl;hn=z;$n=de;gn=ws;pn=Zo;_n=zi;vn=Wi;yn=Ki;xn=Bi;mn=Io;Nn=hc;Tn=cc;En=uc;Cn=fc;Sn=dc;On=Se;bn=Ar;Mn=Pr;Dn=Fe;wn=ze;An=Be;Pn=kl;kn=Le;In=Pi;Rn=Pt;Ln=So;Fn=wi;Kn=Ai;Bn=ki;zn=qo;Wn=Xo;Un=jo;Gn=Jo;Yn=wo;Hn=Ee;Vn=Qo;Jn=Fi;jn=ce;Xn=Ri;qn=Ke;Qn=Or;Zn=Wo;er=Ko;tr=Lo;nr=zo;rr=Go;or=Ho;sr=Ro;ir=st;ar=Yo;lr=es;cr=Uo;fr=Vo;dr=Pe;ur=Fo;hr=Bo;$r=Li;gr=br;pr=Re;_r=wr;vr=Mr;yr=Ae;xr=Sr;mr=Ie;Nr=Dr;Tr=D;Er=gc;Cr=Ue});export default _c();

//# sourceMappingURL=Lexical.prod.js.map
